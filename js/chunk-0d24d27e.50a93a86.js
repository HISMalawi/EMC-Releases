(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0d24d27e"],{"313e":function(e,t,n){"use strict";n.r(t);n("b64b"),n("a4d3"),n("e01a");var r=n("7a23"),o=Object(r["withScopeId"])("data-v-7217b18a");Object(r["pushScopeId"])("data-v-7217b18a");var c=Object(r["createVNode"])("label",{class:"his-title"}," Prescribe BP drugs ",-1),a={key:0,class:"view-port-content"},i={id:"main-table",style:{width:"100%"}},l=Object(r["createVNode"])("th",null," ",-1),u=Object(r["createVNode"])("td",{class:"td-remaining td-title"},[Object(r["createVNode"])("span",null,"New/Current")],-1),s=Object(r["createVNode"])("td",{class:"td-remaining td-title"},[Object(r["createVNode"])("span",null," ")],-1),d=Object(r["createTextVNode"])(" Add notes "),b=Object(r["createVNode"])("p",null,null,-1),O={id:"table-notes",style:{width:"100%"}},j=Object(r["createVNode"])("caption",{style:{"font-size":"1.2em"}}," Notes ",-1),f=Object(r["createVNode"])("p",null,null,-1),p={class:"table-inner-notes",id:"notes-HCZ"},g={class:"date-td today-td"},m={class:"date-td today-td"},h=Object(r["createTextVNode"])(" X "),k=Object(r["createTextVNode"])(" cancel "),v=Object(r["createTextVNode"])(" Clear Session Prescription "),N=Object(r["createTextVNode"])(" Continue ");Object(r["popScopeId"])();var C=o((function(e,t,n,C,V,B){var w=Object(r["resolveComponent"])("ion-col"),y=Object(r["resolveComponent"])("ion-row"),x=Object(r["resolveComponent"])("ion-toolbar"),D=Object(r["resolveComponent"])("ion-header"),I=Object(r["resolveComponent"])("ion-checkbox"),F=Object(r["resolveComponent"])("ion-button"),_=Object(r["resolveComponent"])("view-port"),T=Object(r["resolveComponent"])("ion-content"),S=Object(r["resolveComponent"])("ion-footer"),P=Object(r["resolveComponent"])("ion-page");return Object(r["openBlock"])(),Object(r["createBlock"])(P,null,{default:o((function(){return[Object(r["createVNode"])(D,null,{default:o((function(){return[Object(r["createVNode"])(x,null,{default:o((function(){return[Object(r["createVNode"])(y,null,{default:o((function(){return[Object(r["createVNode"])(w,null,{default:o((function(){return[c]})),_:1})]})),_:1})]})),_:1})]})),_:1}),Object(r["createVNode"])(T,null,{default:o((function(){return[Object(r["createVNode"])(_,null,{default:o((function(){return[e.drugs?(Object(r["openBlock"])(),Object(r["createBlock"])("div",a,[Object(r["createVNode"])("table",i,[Object(r["createVNode"])("tr",null,[l,(Object(r["openBlock"])(!0),Object(r["createBlock"])(r["Fragment"],null,Object(r["renderList"])(e.drugs,(function(e,t){return Object(r["openBlock"])(),Object(r["createBlock"])("th",{key:t},[Object(r["createTextVNode"])(Object(r["toDisplayString"])(t)+" ",1),Object(r["createVNode"])(y,null,{default:o((function(){return[(Object(r["openBlock"])(!0),Object(r["createBlock"])(r["Fragment"],null,Object(r["renderList"])(e.drugs,(function(e,t){return Object(r["openBlock"])(),Object(r["createBlock"])(w,{class:"col-borders",key:t},{default:o((function(){return[Object(r["createTextVNode"])(Object(r["toDisplayString"])(e.amount||"0mg"),1)]})),_:2},1024)})),128))]})),_:2},1024)])})),128))]),Object(r["createVNode"])("tr",null,[u,(Object(r["openBlock"])(!0),Object(r["createBlock"])(r["Fragment"],null,Object(r["renderList"])(e.drugs,(function(t,n){return Object(r["openBlock"])(),Object(r["createBlock"])("td",{key:n,class:"td-current td-value"},[Object(r["createVNode"])(y,null,{default:o((function(){return[(Object(r["openBlock"])(!0),Object(r["createBlock"])(r["Fragment"],null,Object(r["renderList"])(t.drugs,(function(t,c){return Object(r["openBlock"])(),Object(r["createBlock"])(w,{key:c},{default:o((function(){return[Object(r["createVNode"])(I,{checked:t.selected,onIonChange:function(t){return e.selectDrug(n,c,t)}},null,8,["checked","onIonChange"])]})),_:2},1024)})),128))]})),_:2},1024)])})),128))]),Object(r["createVNode"])("tr",null,[s,(Object(r["openBlock"])(!0),Object(r["createBlock"])(r["Fragment"],null,Object(r["renderList"])(Object.keys(e.drugs),(function(t,n){return Object(r["openBlock"])(),Object(r["createBlock"])("td",{class:"td-remaining td-value",key:n},[Object(r["createVNode"])(y,null,{default:o((function(){return[Object(r["createVNode"])(w,null,{default:o((function(){return[Object(r["createVNode"])(F,{onClick:function(n){return e.launchNotePad(t)},color:"warning"},{default:o((function(){return[d]})),_:1},8,["onClick"])]})),_:1})]})),_:1})])})),128))])]),b,Object(r["createVNode"])("table",O,[j,f,Object(r["createVNode"])("tr",null,[(Object(r["openBlock"])(!0),Object(r["createBlock"])(r["Fragment"],null,Object(r["renderList"])(e.drugs,(function(e,t){return Object(r["openBlock"])(),Object(r["createBlock"])("th",{style:{width:"25%"},key:t},[Object(r["createVNode"])("span",null,Object(r["toDisplayString"])(t),1)])})),128))]),Object(r["createVNode"])("tr",null,[(Object(r["openBlock"])(!0),Object(r["createBlock"])(r["Fragment"],null,Object(r["renderList"])(Object.keys(e.drugs),(function(t,n){return Object(r["openBlock"])(),Object(r["createBlock"])("td",{id:"HCZ",style:{"padding-top":"2px !important"},valign:"top",key:n},[Object(r["createVNode"])("table",p,[(Object(r["openBlock"])(!0),Object(r["createBlock"])(r["Fragment"],null,Object(r["renderList"])(e.drugs[t].notes,(function(n,c){return Object(r["openBlock"])(),Object(r["createBlock"])("tr",{key:c},[Object(r["createVNode"])("td",g,Object(r["toDisplayString"])(n.date),1),Object(r["createVNode"])("td",m,Object(r["toDisplayString"])(n.description),1),Object(r["createVNode"])("td",null,[n.isNewNote?(Object(r["openBlock"])(),Object(r["createBlock"])(F,{key:0,color:"danger",onClick:function(n){return e.removeNote(t,c)}},{default:o((function(){return[h]})),_:1},8,["onClick"])):Object(r["createCommentVNode"])("",!0)])])})),128))])])})),128))])])])):Object(r["createCommentVNode"])("",!0)]})),_:1})]})),_:1}),Object(r["createVNode"])(S,null,{default:o((function(){return[Object(r["createVNode"])(x,{color:"dark"},{default:o((function(){return[Object(r["createVNode"])(F,{size:"large",color:"danger",slot:"start",onClick:e.gotoPatientDashboard},{default:o((function(){return[k]})),_:1},8,["onClick"]),e.canClearHtnSessionPrescription?(Object(r["openBlock"])(),Object(r["createBlock"])(F,{key:0,size:"large",color:"warning",slot:"end",onClick:e.clearPrescriptionInSession},{default:o((function(){return[v]})),_:1},8,["onClick"])):Object(r["createCommentVNode"])("",!0),e.selectedDrugs&&e.selectedDrugs.length>0?(Object(r["openBlock"])(),Object(r["createBlock"])(F,{key:1,size:"large",color:"success",slot:"end",onClick:e.onFinish},{default:o((function(){return[N]})),_:1},8,["onClick"])):Object(r["createCommentVNode"])("",!0)]})),_:1})]})),_:1})]})),_:1})})),V=n("1da1"),B=(n("a434"),n("d81d"),n("4de4"),n("d3b7"),n("07ac"),n("99af"),n("3ca3"),n("ddb0"),n("e9c4"),n("159b"),n("96cf"),n("0a79")),w=n("d95e"),y=n("e6e9"),x=n("8a30"),D=n("7365"),I=n("32b3"),F=n("ad60"),_=n("b5e4"),T=n("2ef0"),S=Object(r["defineComponent"])({mixins:[D["a"]],components:{ViewPort:B["a"],IonToolbar:x["Q"],IonHeader:x["q"],IonContent:x["n"],IonRow:x["H"],IonButton:x["d"],IonCol:x["m"],IonFooter:x["o"],IonPage:x["D"],IonCheckbox:x["k"]},watch:{ready:{handler:function(e){var t=this;return Object(V["a"])(regeneratorRuntime.mark((function n(){var r,o,c;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(!e){n.next=11;break}return t.HTN=new I["a"](t.patientID,t.providerID),t.drugs=t.HTN.getDrugs(),n.next=5,t.HTN.getCurrentDrugs();case 5:r=n.sent,o=r.drugs,c=r.notes,t.setPreviousBpDrugs(o),t.setPreviousBpNotes(c),t.canClearHtnSessionPrescription=t.patientHasHtnSessionKey();case 11:case"end":return n.stop()}}),n)})))()},immediate:!0}},data:function(){return{HTN:{},drugs:null,canClearHtnSessionPrescription:!1}},methods:{clearPrescriptionInSession:function(){sessionStorage.removeItem(I["b"].Prescription),this.canClearHtnSessionPrescription=!1},patientHasHtnSessionKey:function(){try{var e=sessionStorage.getItem(I["b"].Prescription);if(e){var t=JSON.parse(e);return t[this.patientID]}}catch(n){console.warn(n)}return!1},removeNote:function(e,t,n){this.drugs[e].notes.splice(n,1)},launchNotePad:function(e){var t=this;this.showModal({id:"note",helpText:"Add notes for ".concat(e),type:w["b"].TT_TEXT},(function(n){n&&t.drugs[e].notes.push({date:F["a"].getSessionDate(),description:n.value||"",drugID:t.drugs[e].drugs[0].drugID,isNewNote:!0})}))},onFinish:function(){var e=this;return Object(V["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=Object.values(e.drugs).filter((function(e){return!Object(T["isEmpty"])(e.notes)})).map((function(e){return e.notes})).reduce((function(e,t){return e.concat(t)}),[]).filter((function(e){return e.isNewNote})).map((function(t){return e.HTN.buildObs("Clinician notes",{value_text:t.description,value_drug:t.drugID})})),Object(T["isEmpty"])(n)){t.next=16;break}return t.prev=2,t.next=5,e.HTN.createEncounter();case 5:return t.t0=e.HTN,t.next=8,Promise.all(n);case 8:return t.t1=t.sent,t.next=11,t.t0.saveObservationList.call(t.t0,t.t1);case 11:t.next=16;break;case 13:return t.prev=13,t.t2=t["catch"](2),t.abrupt("return",Object(_["e"])("Unable to save notes ".concat(t.t2)));case 16:e.gotoTreatment();case 17:case"end":return t.stop()}}),t,null,[[2,13]])})))()},gotoTreatment:function(){var e=this.selectedDrugs.map((function(e){return Object(T["find"])(I["a"].htnDrugReferences(),{drug_id:e.drugID})})),t={};t[this.patientID]=e,sessionStorage.setItem(I["b"].Prescription,JSON.stringify(t)),this.$router.push("/art/encounters/prescriptions/".concat(this.patientID))},showModal:function(e,t){return Object(V["a"])(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,x["X"].create({component:y["a"],backdropDismiss:!1,cssClass:"full-modal",componentProps:{dismissType:"modal",currentField:e,onFinish:t}});case 2:r=n.sent,r.present();case 4:case"end":return n.stop()}}),n)})))()},setPreviousBpNotes:function(e){var t=this,n=function(n){t.drugs[n].notes=Object.keys(e[n]).map((function(t){return e[n][t].map((function(e){return{date:t,description:e,isNewNote:!1}}))})).reduce((function(e,t){return e.concat(t)}),[])};for(var r in e)n(r)},setPreviousBpDrugs:function(e){var t=this;e.forEach((function(e){var n=function(n){t.drugs[n].drugs.forEach((function(r,o){e.drug_id===r.drugID&&(t.drugs[n].drugs[o].current=!0,t.drugs[n].drugs[o].selected=!0,t.drugs[n].selected=e.drug_id)}))};for(var r in t.drugs)n(r)}))},selectDrug:function(e,t,n){var r=this;this.drugs[e].drugs.forEach((function(t,n){r.drugs[e].drugs[n].selected=!1})),this.drugs[e].drugs[t].selected=n.detail.checked}},computed:{selectedDrugs:function(){return this.drugs?Object.values(this.drugs).map((function(e){return e.drugs})).reduce((function(e,t){return e.concat(t)}),[]).filter((function(e){return e.selected})):[]}}}),P=(n("c2f2"),n("6b0d")),H=n.n(P);const L=H()(S,[["render",C],["__scopeId","data-v-7217b18a"]]);t["default"]=L},4582:function(e,t,n){},c2f2:function(e,t,n){"use strict";n("4582")},e6e9:function(e,t,n){"use strict";var r=n("7a23"),o=Object(r["createTextVNode"])(" Close "),c=Object(r["createTextVNode"])(" Clear "),a=Object(r["createTextVNode"])(" Done ");function i(e,t,n,i,l,u){var s=Object(r["resolveComponent"])("ion-title"),d=Object(r["resolveComponent"])("ion-toolbar"),b=Object(r["resolveComponent"])("ion-header"),O=Object(r["resolveComponent"])("ion-content"),j=Object(r["resolveComponent"])("ion-button"),f=Object(r["resolveComponent"])("ion-footer"),p=Object(r["resolveComponent"])("ion-page");return Object(r["openBlock"])(),Object(r["createBlock"])(p,null,{default:Object(r["withCtx"])((function(){return[Object(r["createVNode"])(b,null,{default:Object(r["withCtx"])((function(){return[Object(r["createVNode"])(d,null,{default:Object(r["withCtx"])((function(){return[Object(r["createVNode"])(s,{class:"his-lg-text ion-text-center"},{default:Object(r["withCtx"])((function(){return[Object(r["createTextVNode"])(Object(r["toDisplayString"])(e.currentField.helpText),1)]})),_:1})]})),_:1})]})),_:1}),Object(r["createVNode"])(O,null,{default:Object(r["withCtx"])((function(){return[(Object(r["openBlock"])(),Object(r["createBlock"])(r["KeepAlive"],null,[(Object(r["openBlock"])(),Object(r["createBlock"])(Object(r["resolveDynamicComponent"])(e.currentField.type),{key:e.currentField.id,currentFieldig:e.currentField.currentFieldig,options:e.currentField.options,preset:e.currentField.preset,clear:e.valueClearIndex,fdata:e.formData,config:e.currentField.config,cdata:e.computedFormData,activationState:e.state,onValue:e.currentField.onValue,defaultValue:e.currentField.defaultValue,onValueUpdate:e.currentField.onValueUpdate,onOnValue:e.onFieldValue},null,8,["currentFieldig","options","preset","clear","fdata","config","cdata","activationState","onValue","defaultValue","onValueUpdate","onOnValue"]))],1024))]})),_:1}),Object(r["createVNode"])(f,null,{default:Object(r["withCtx"])((function(){return[Object(r["createVNode"])(d,{color:"light"},{default:Object(r["withCtx"])((function(){return[Object(r["createVNode"])(j,{disabled:e.disableBtn,onClick:e.onClose,slot:"start",color:"danger",size:"large"},{default:Object(r["withCtx"])((function(){return[o]})),_:1},8,["disabled","onClick"]),Object(r["createVNode"])(j,{disabled:e.disableBtn,onClick:e.onClear,slot:"end",color:"warning",size:"large"},{default:Object(r["withCtx"])((function(){return[c]})),_:1},8,["disabled","onClick"]),Object(r["createVNode"])(j,{disabled:e.disableBtn,onClick:e.onDone,slot:"end",color:"success",size:"large"},{default:Object(r["withCtx"])((function(){return[a]})),_:1},8,["disabled","onClick"])]})),_:1})]})),_:1})]})),_:1})}var l=n("5530"),u=(n("d3b7"),n("159b"),n("3ca3"),n("ddb0"),n("a15b"),n("b5e4")),s=n("d95e"),d=n("8a30");function b(){var e={};return s["a"].forEach((function(t){e[t]=Object(r["defineAsyncComponent"])((function(){return n("f159")("./".concat(t,".vue"))}))})),e}var O=Object(r["defineComponent"])({name:"SingleFieldTouchForm",components:Object(l["a"])({IonPage:d["D"],IonContent:d["n"],IonFooter:d["o"],IonToolbar:d["Q"],IonButton:d["d"],IonHeader:d["q"],IonTitle:d["P"]},b()),props:{dismissType:{type:String},onFinish:{type:Function,required:!0},currentField:{type:Object,required:!0}},data:function(){return{valueClearIndex:0,formData:{},computedFormData:{},state:"",value:null,disableBtn:!1}},methods:{onClose:function(){"modal"===this.dismissType?d["X"].dismiss():this.$router.back()},onClear:function(){this.valueClearIndex+=1,this.value=null},onFieldValue:function(e){this.value=e},onDone:function(){if(this.disableBtn=!0,this.currentField.validation){var e=this.currentField.validation(this.value);if(this.disableBtn=!1,e)return Object(u["e"])(e.join(", "),6e4)}try{this.onFinish(this.value)}catch(t){Object(u["c"])(t),console.error(t)}this.onClose(),this.disableBtn=!1}}}),j=n("6b0d"),f=n.n(j);const p=f()(O,[["render",i]]);t["a"]=p}}]);
//# sourceMappingURL=chunk-0d24d27e.50a93a86.js.map