{"version":3,"sources":["webpack:///./src/apps/OPD/views/encounters/radiology.vue?12d4","webpack:///./src/apps/OPD/views/encounters/radiology.vue","webpack:///./src/apps/OPD/views/encounters/radiology.vue?9f90"],"names":["render","_ctx","_cache","$props","$setup","$data","$options","_component_his_standard_form","_resolveComponent","_component_ion_page","_openBlock","_createBlock","default","_withCtx","_createVNode","cancelDestinationPath","cancelDestination","fields","onFinishAction","onSubmit","_","defineComponent","components","HisStandardForm","mixins","EncounterMixinVue","data","radiologyService","isPacsEnabled","previousRadiologyExaminations","watch","ready","handler","isReady","PatientRadiologyService","patientID","providerID","OPD_GLOBAL_PROP","isPACsEnabled","showPreviousRadiolgy","patient","getFields","immediate","deep","methods","computedData","Promise","all","radiology","createEncounter","obsObj","saveObservationList","savedObsData","printOrders","submitToPacs","console","log","gotoPatientDashboard","getTableData","getPreviousRadiologyExaminations","order","params","url","columns","rows","row","children","accession_number","value_text","moment","obs_datetime","format","push","label","value","other","id","helpText","condition","type","FieldType","TT_TABLE_VIEWER","options","d","config","hiddenFooterBtns","TT_RADIOLOGY_PICKER","validation","Validation","required","this","disableBackBtn","computedValue","map","option","buildValueCoded","parent","buildValueCodedFromConceptId","concept_id","child","__exports__"],"mappings":"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","file":"js/chunk-2d0cf669.5f4ce479.js","sourcesContent":["import { resolveComponent as _resolveComponent, createVNode as _createVNode, withCtx as _withCtx, openBlock as _openBlock, createBlock as _createBlock } from \"vue\"\n\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_his_standard_form = _resolveComponent(\"his-standard-form\")\n  const _component_ion_page = _resolveComponent(\"ion-page\")\n\n  return (_openBlock(), _createBlock(_component_ion_page, null, {\n    default: _withCtx(() => [\n      _createVNode(_component_his_standard_form, {\n        cancelDestinationPath: _ctx.cancelDestination,\n        fields: _ctx.fields,\n        onFinishAction: _ctx.onSubmit\n      }, null, 8, [\"cancelDestinationPath\", \"fields\", \"onFinishAction\"])\n    ]),\n    _: 1\n  }))\n}","\nimport { defineComponent } from 'vue'\nimport HisStandardForm from \"@/components/Forms/TouchScreenForm.vue\";\nimport EncounterMixinVue from '@/views/EncounterMixin.vue';\nimport { PatientRadiologyService } from \"@/apps/OPD/services/patient_radiology_service\";\nimport Validation from '@/components/Forms/validations/StandardValidations';\nimport { Field, Option } from '@/components/Forms/FieldInterface';\nimport { FieldType } from '@/components/Forms/BaseFormElements';\nimport OPD_GLOBAL_PROP from \"@/apps/OPD/opd_global_props\";\nimport moment from \"dayjs\";\n\nexport default defineComponent({\n  components: { HisStandardForm },\n  mixins: [EncounterMixinVue],\n  data: () => ({\n    radiologyService: {} as any,\n    isPacsEnabled: false,\n    previousRadiologyExaminations: {} as any\n  }),\n  watch: {\n    ready: {\n      async handler(isReady: boolean) {\n        if(isReady){\n          this.radiologyService = new PatientRadiologyService(this.patientID, this.providerID)\n          this.isPacsEnabled = (await OPD_GLOBAL_PROP.isPACsEnabled())\n          this.previousRadiologyExaminations = await this.radiologyService.showPreviousRadiolgy(this.patient)\n          this.fields = this.getFields()\n        }\n      },\n      immediate: true,\n      deep: true\n    }\n  },\n  methods: {\n    async onSubmit(_: any, computedData: any){\n      const data = await Promise.all(computedData.radiology)\n      await this.radiologyService.createEncounter()\n      const obsObj = await this.radiologyService.obsObj(data) \n      const savedObsData = await this.radiologyService.saveObservationList(obsObj)\n      await this.radiologyService.printOrders(data, this.patient)\n      if(this.isPacsEnabled) {\n        try {\n          await this.radiologyService.submitToPacs(savedObsData, this.patient)\n        } catch (error) {\n          console.log(error)\n        }\n      }\n      this.gotoPatientDashboard()\n    },\n    async getTableData() {\n      const params = await this.radiologyService.getPreviousRadiologyExaminations(this.patient)\n      const data = params.data\n      const url = params.url\n      const columns = ['Accession#','Body Part', 'Order Type', 'Ordered', 'Result']\n      const rows = [] as Array<any>\n      for (const order in data) {\n        const row = [\n          data[order].children[0].accession_number,\n          data[order].value_text,\n          data[order].children[0].value_text,\n          moment(data[order].obs_datetime).format('DD/MMM/YYYY'),\n          `<ion-button slot=\"end\" size=\"large\" href=\"${url}\" color=\"success\">\n            View\n          </ion-button>`\n        ]\n        rows.push(row)\n      }\n      return [\n        {\n          label: '',\n          value: '',\n          other: { columns, rows},\n        },\n      ];\n    },\n    getFields(): Array<Field>{\n      return [\n        {\n          id: 'radiology_results',\n          helpText: 'Previous Radiology Examinations',\n          condition: () => this.previousRadiologyExaminations,\n          type: FieldType.TT_TABLE_VIEWER,\n          options: (d: any) => this.getTableData(),\n          config: {\n            hiddenFooterBtns: [\"Clear\"],\n          },\n        },\n        {\n          id: 'radiology',\n          helpText: 'Radiology Examination',\n          type: FieldType.TT_RADIOLOGY_PICKER,\n          validation: (data: any) => Validation.required(data),\n          config: {\n            hiddenFooterBtns: [ this.disableBackBtn() ],\n          },\n          computedValue: (options: Option[]) => {\n            return options.map(async (option)=> ({\n              ...(await this.radiologyService.buildValueCoded('Radiology Orders', option.other.parent)),\n              child: (await this.radiologyService.buildValueCodedFromConceptId(option.other.parent, option.other.concept_id))\n            }))\n          },\n        },\n      ]\n    },\n    disableBackBtn() {\n      if(this.previousRadiologyExaminations) {\n        return ''\n      } else return 'Back'\n    }\n  }\n})\n","import { render } from \"./radiology.vue?vue&type=template&id=186fde49&ts=true\"\nimport script from \"./radiology.vue?vue&type=script&lang=ts\"\nexport * from \"./radiology.vue?vue&type=script&lang=ts\"\n\nimport exportComponent from \"/home/andrew-dev/Projects/HIS-Core/node_modules/vue-loader-v16/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"sourceRoot":""}