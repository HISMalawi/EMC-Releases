{"version":3,"sources":["webpack:///./src/apps/OPD/views/encounters/Prescription.vue?a71d","webpack:///./src/apps/OPD/services/drug_prescription_service.ts","webpack:///./src/apps/OPD/components/PrescriptionModal.vue?51ab","webpack:///./src/apps/OPD/components/FrequencyCard.vue?2048","webpack:///./src/apps/OPD/components/FrequencyCard.vue","webpack:///./src/apps/OPD/components/FrequencyCard.vue?e558","webpack:///./src/components/Keyboard/HisIntervalKeyboard.vue?7cba","webpack:///./src/components/Keyboard/HisIntervalKeyboard.vue","webpack:///./src/components/Keyboard/HisIntervalKeyboard.vue?ad05","webpack:///./src/apps/OPD/components/PrescriptionModal.vue","webpack:///./src/apps/OPD/components/PrescriptionModal.vue?0287","webpack:///./src/apps/OPD/views/encounters/Prescription.vue","webpack:///./src/apps/OPD/views/encounters/Prescription.vue?b134","webpack:///./src/apps/OPD/components/FrequencyCard.vue?a5ed","webpack:///./src/components/Keyboard/HisIntervalKeyboard.vue?522a","webpack:///./src/apps/OPD/components/PrescriptionModal.vue?ba65"],"names":["render","_ctx","_cache","$props","$setup","$data","$options","_component_his_standard_form","_resolveComponent","_openBlock","_createBlock","cancelDestinationPath","cancelDestination","fields","activeField","onFinishAction","onSubmit","DRUG_DOSE_FREQUENCIES","1","2","3","4","ANTI_MALARIA_DRUGS","DrugPrescriptionService","patientID","providerID","drugs","filter","getJson","name","this","isEmpty","map","drug","label","value","other","getMalariaTestResult","malariaTestResult","getMalariaDiagnosis","malariaDiagnosis","AppEncounterService","getFirstValueCoded","getFirstValueText","drugOrders","DrugOrderService","create","encounterID","_withId","_withScopeId","_pushScopeId","_hoisted_1","_createTextVNode","_hoisted_2","class","_hoisted_3","_hoisted_4","_popScopeId","_component_ion_title","_component_ion_toolbar","_component_ion_header","_component_ion_label","_component_ion_item","_component_ion_list","_component_ion_col","_component_frequency_card","_component_ion_row","_component_interval_keyboard","_component_ion_grid","_component_ion_content","_component_ion_button","_component_ion_footer","_Fragment","_createVNode","default","_","style","overflowY","background","size","height","borderRight","_renderList","index","key","detail","onClick","activeIndex","color","_toDisplayString","instructions","Object","keys","frequencies","title","status","$event","setFrequency","unit","onOnValue","setDuration","_createCommentVNode","closeModal","slot","savePrescriptions","_component_ion_card_subtitle","_component_ion_card_content","_component_ion_card","active","src","icon","alt","cardTitle","defineComponent","props","type","String","required","Boolean","components","IonCard","IonCardContent","IonCardSubtitle","setup","computed","Strings","capitalizeFirstLetter","__exports__","_component_his_keyboard","ranges","range","generateKeypad","start","end","keyboard","kbConfig","onKeyPress","disabled","HisKeyboard","IonRow","IonCol","IonList","IonItem","IonLabel","emits","emit","ref","text","numbers","row","counter","i","push","findIndex","r","onMounted","prescribedDrugs","d","duration","frequency","morning","noon","evening","night","getFrequencyCount","values","length","drugname","freq","parseInt","isComplete","toastWarning","modalController","dismiss","IonContent","IonButton","IonHeader","IonTitle","IonToolbar","FrequencyCard","IntervalKeyboard","HisStandardForm","mixins","EncounterMixinVue","data","prescriptionService","hasMalaria","watch","ready","handler","isReady","loadDrugs","getFields","immediate","deep","methods","createEncounter","encounter","createDrugOrder","drugOrder","toastSuccess","nextTask","getPrescriptionDetails","component","PrescriptionModalVue","backdropDismiss","cssClass","componentProps","modal","present","onDidDismiss","calculateExpireDate","startDate","date","Date","setDate","getDate","HisDate","toStandardHisFormat","mapToOrders","prescriptions","getSessionDate","frequencyCount","drug_id","dose_strength","units","id","helpText","FieldType","TT_MULTIPLE_SELECT","validation","Validation","options","getDrugOptions","onload","beforeNext","config","showKeyboard","footerBtns","visible","alertConfirmation","ok","TT_SELECT","condition","onValue"],"mappings":"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","file":"js/chunk-0a163f3e.8ea981b1.js","sourcesContent":["import { resolveComponent as _resolveComponent, createVNode as _createVNode, openBlock as _openBlock, createBlock as _createBlock } from \"vue\"\n\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_his_standard_form = _resolveComponent(\"his-standard-form\")\n\n  return (_openBlock(), _createBlock(_component_his_standard_form, {\n    cancelDestinationPath: _ctx.cancelDestination,\n    fields: _ctx.fields,\n    activeField: _ctx.activeField,\n    onFinishAction: _ctx.onSubmit\n  }, null, 8, [\"cancelDestinationPath\", \"fields\", \"activeField\", \"onFinishAction\"]))\n}","import { ConceptName } from \"@/interfaces/conceptName\";\nimport { DrugInterface } from \"@/interfaces/Drug\";\nimport { AppEncounterService } from \"@/services/app_encounter_service\"\nimport { DrugOrderService } from \"@/services/drug_order_service\";\nimport { isEmpty } from \"lodash\";\n\nexport const DRUG_DOSE_FREQUENCIES: Record<number, string> = {\n  1: \"OD\", \n  2: \"BD\",\n  3: \"TDS\", \n  4: \"QID\"\n}\n\nexport const ANTI_MALARIA_DRUGS = [\n  {\n    'drug_id': 236,\n    'duration': 3,\n    'tabs': 6,\n    'name': \"Lumefantrine + Arthemether 1 x 6\",\n    'dose_strength': 1.0,\n    'units': \"tabs\",\n    'frequency': 2\n  },\n  {\n    'drug_id': 237,\n    'duration': 3,\n    'tabs': 12,\n    'name': \"Lumefantrine + Arthemether 2 x 6\",\n    'dose_strength': 2.0,\n    'units': \"tabs\",\n    'frequency': 2\n  },\n  {\n    'drug_id': 238,\n    'duration': 3,\n    'tabs': 18,\n    'name': \"Lumefantrine + Arthemether 3 x 6\",\n    'dose_strength': 3.0,\n    'units': \"tabs\",\n    'frequency': 2\n  },\n  {\n    'drug_id': 239,\n    'duration': 3,\n    'tabs': 24,\n    'name': \"Lumefantrine + Arthemether 4 x 6\",\n    'dose_strength': 4.0,\n    'units': \"tabs\",\n    'frequency': 2\n  }\n];\n\nexport class DrugPrescriptionService extends AppEncounterService {\n  drugs: ConceptName[] = [];\n  constructor(patientID: number, providerID: number) {\n    super(patientID, 25, providerID) \n  }\n  async loadDrugs(filter = '') {\n    this.drugs = await DrugPrescriptionService.getJson('drugs', {\n      'page_size': 1000000,\n      name: filter\n    })\n  }\n  getDrugOptions() {\n    if(isEmpty(this.drugs)) return []\n    return this.drugs.map(drug => ({\n      label: drug.name, value: drug.name, other: drug\n    }))\n  }\n  async hasMalaria() {\n    const malariaTestResult = await this.getMalariaTestResult()\n    if(malariaTestResult) return true\n    const malariaDiagnosis = await this.getMalariaDiagnosis()\n    if(malariaDiagnosis) return true\n    return false\n  }\n  async getMalariaTestResult() {\n    let malariaTestResult = await AppEncounterService.getFirstValueCoded(this.patientID, 'Malaria Test Result')   \n    if(malariaTestResult) return malariaTestResult\n    malariaTestResult = await AppEncounterService.getFirstValueText(this.patientID, 'Malaria Test Result')\n    if(malariaTestResult) return malariaTestResult\n    return null\n  }\n  async getMalariaDiagnosis() {\n    return AppEncounterService.getFirstValueCoded(this.patientID, 'Malaria')\n  }\n  createDrugOrder(drugOrders: Array<DrugInterface>){\n    return DrugOrderService.create({\n      'encounter_id': this.encounterID,\n      'drug_orders': drugOrders\n    })\n  }\n}","import { createTextVNode as _createTextVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, createVNode as _createVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createBlock as _createBlock, toDisplayString as _toDisplayString, createCommentVNode as _createCommentVNode, withScopeId as _withScopeId, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\nconst _withId = /*#__PURE__*/_withScopeId(\"data-v-586626f5\")\n\n_pushScopeId(\"data-v-586626f5\")\nconst _hoisted_1 = /*#__PURE__*/_createTextVNode(\"Complete prescription details\")\nconst _hoisted_2 = { class: \"side-title\" }\nconst _hoisted_3 = /*#__PURE__*/_createTextVNode(\" Close \")\nconst _hoisted_4 = /*#__PURE__*/_createTextVNode(\"Save \")\n_popScopeId()\n\nexport const render = /*#__PURE__*/_withId(function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_ion_title = _resolveComponent(\"ion-title\")\n  const _component_ion_toolbar = _resolveComponent(\"ion-toolbar\")\n  const _component_ion_header = _resolveComponent(\"ion-header\")\n  const _component_ion_label = _resolveComponent(\"ion-label\")\n  const _component_ion_item = _resolveComponent(\"ion-item\")\n  const _component_ion_list = _resolveComponent(\"ion-list\")\n  const _component_ion_col = _resolveComponent(\"ion-col\")\n  const _component_frequency_card = _resolveComponent(\"frequency-card\")\n  const _component_ion_row = _resolveComponent(\"ion-row\")\n  const _component_interval_keyboard = _resolveComponent(\"interval-keyboard\")\n  const _component_ion_grid = _resolveComponent(\"ion-grid\")\n  const _component_ion_content = _resolveComponent(\"ion-content\")\n  const _component_ion_button = _resolveComponent(\"ion-button\")\n  const _component_ion_footer = _resolveComponent(\"ion-footer\")\n\n  return (_openBlock(), _createBlock(_Fragment, null, [\n    _createVNode(_component_ion_header, null, {\n      default: _withId(() => [\n        _createVNode(_component_ion_toolbar, null, {\n          default: _withId(() => [\n            _createVNode(_component_ion_title, null, {\n              default: _withId(() => [\n                _hoisted_1\n              ]),\n              _: 1\n            })\n          ]),\n          _: 1\n        })\n      ]),\n      _: 1\n    }),\n    _createVNode(_component_ion_content, { style: { overflowY: 'hidden', background: 'grey' } }, {\n      default: _withId(() => [\n        _createVNode(_component_ion_grid, null, {\n          default: _withId(() => [\n            _createVNode(_component_ion_row, null, {\n              default: _withId(() => [\n                _createVNode(_component_ion_col, { size: \"4\" }, {\n                  default: _withId(() => [\n                    _createVNode(_component_ion_list, { style: {overflowY: 'auto', height:'78vh', borderRight: 'solid 1px #ccc'} }, {\n                      default: _withId(() => [\n                        (_openBlock(true), _createBlock(_Fragment, null, _renderList(_ctx.drugs, (drug, index) => {\n                          return (_openBlock(), _createBlock(_component_ion_item, {\n                            key: drug,\n                            detail: true,\n                            onClick: () => _ctx.activeIndex = index,\n                            color: _ctx.activeIndex === index ? 'light' : ''\n                          }, {\n                            default: _withId(() => [\n                              _createVNode(_component_ion_label, null, {\n                                default: _withId(() => [\n                                  _createTextVNode(_toDisplayString(drug.name), 1 /* TEXT */)\n                                ]),\n                                _: 2\n                              }, 1024)\n                            ]),\n                            _: 2\n                          }, 1032, [\"onClick\", \"color\"]))\n                        }), 128 /* KEYED_FRAGMENT */))\n                      ]),\n                      _: 1\n                    })\n                  ]),\n                  _: 1\n                }),\n                _createVNode(_component_ion_col, { style: {overflowY: 'auto', height:'78vh'} }, {\n                  default: _withId(() => [\n                    (_ctx.activeIndex >= 0)\n                      ? (_openBlock(), _createBlock(_Fragment, { key: 0 }, [\n                          _createVNode(\"div\", _hoisted_2, _toDisplayString(_ctx.instructions), 1),\n                          _createVNode(_component_ion_row, { class: \"frequencies\" }, {\n                            default: _withId(() => [\n                              (_openBlock(true), _createBlock(_Fragment, null, _renderList(Object.keys(_ctx.frequencies), (key) => {\n                                return (_openBlock(), _createBlock(_component_ion_col, { key: key }, {\n                                  default: _withId(() => [\n                                    _createVNode(_component_frequency_card, {\n                                      title: key,\n                                      status: _ctx.frequencies[key],\n                                      onClick: $event => (_ctx.setFrequency(key))\n                                    }, null, 8, [\"title\", \"status\", \"onClick\"])\n                                  ]),\n                                  _: 2\n                                }, 1024))\n                              }), 128 /* KEYED_FRAGMENT */))\n                            ]),\n                            _: 1\n                          }),\n                          _createVNode(_component_interval_keyboard, {\n                            unit: \"days\",\n                            title: \"Select Duration\",\n                            onOnValue: _ctx.setDuration\n                          }, null, 8, [\"onOnValue\"])\n                        ], 64 /* STABLE_FRAGMENT */))\n                      : _createCommentVNode(\"\", true)\n                  ]),\n                  _: 1\n                })\n              ]),\n              _: 1\n            })\n          ]),\n          _: 1\n        })\n      ]),\n      _: 1\n    }),\n    _createVNode(_component_ion_footer, null, {\n      default: _withId(() => [\n        _createVNode(_component_ion_toolbar, null, {\n          default: _withId(() => [\n            _createVNode(_component_ion_button, {\n              onClick: _ctx.closeModal,\n              slot: \"start\",\n              color: \"danger\",\n              style: {\"margin-left\":\"1rem\"}\n            }, {\n              default: _withId(() => [\n                _hoisted_3\n              ]),\n              _: 1\n            }, 8, [\"onClick\"]),\n            _createVNode(_component_ion_button, {\n              onClick: _ctx.savePrescriptions,\n              slot: \"end\",\n              style: {\"margin-right\":\"1rem\"}\n            }, {\n              default: _withId(() => [\n                _hoisted_4\n              ]),\n              _: 1\n            }, 8, [\"onClick\"])\n          ]),\n          _: 1\n        })\n      ]),\n      _: 1\n    })\n  ], 64 /* STABLE_FRAGMENT */))\n})","import { createVNode as _createVNode, toDisplayString as _toDisplayString, createTextVNode as _createTextVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, openBlock as _openBlock, createBlock as _createBlock, withScopeId as _withScopeId } from \"vue\"\nconst _withId = /*#__PURE__*/_withScopeId(\"data-v-0dd8dfe4\")\n\nexport const render = /*#__PURE__*/_withId(function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_ion_card_subtitle = _resolveComponent(\"ion-card-subtitle\")\n  const _component_ion_card_content = _resolveComponent(\"ion-card-content\")\n  const _component_ion_card = _resolveComponent(\"ion-card\")\n\n  return (_openBlock(), _createBlock(_component_ion_card, {\n    class: [\"his-card clickable\", { active: _ctx.status }]\n  }, {\n    default: _withId(() => [\n      _createVNode(\"img\", {\n        src: _ctx.icon,\n        alt: _ctx.title,\n        height: \"65\"\n      }, null, 8, [\"src\", \"alt\"]),\n      _createVNode(_component_ion_card_content, null, {\n        default: _withId(() => [\n          _createVNode(_component_ion_card_subtitle, {\n            color: _ctx.status ? 'primary': ''\n          }, {\n            default: _withId(() => [\n              _createTextVNode(_toDisplayString(_ctx.cardTitle), 1 /* TEXT */)\n            ]),\n            _: 1\n          }, 8, [\"color\"])\n        ]),\n        _: 1\n      })\n    ]),\n    _: 1\n  }, 8, [\"class\"]))\n})","\nimport { computed, defineComponent } from 'vue'\nimport Strings from '../utils/Strings'\nimport { IonCard, IonCardContent, IonCardSubtitle } from \"@ionic/vue\";\n\nexport default defineComponent({\n  props: {\n    title: {\n      type: String,\n      required: true\n    },\n    status: {\n      type: Boolean,\n      default: false\n    }\n  },\n  components: { IonCard, IonCardContent, IonCardSubtitle },\n  setup(props) {\n    const cardTitle = computed(() => Strings.capitalizeFirstLetter(props.title))\n    const icon = computed(() => `/assets/images/prescription/${props.title}.png`)\n\n    return {\n      cardTitle,\n      icon,\n    }\n  },\n})\n","import { render } from \"./FrequencyCard.vue?vue&type=template&id=0dd8dfe4&scoped=true&ts=true\"\nimport script from \"./FrequencyCard.vue?vue&type=script&lang=ts\"\nexport * from \"./FrequencyCard.vue?vue&type=script&lang=ts\"\n\nimport \"./FrequencyCard.vue?vue&type=style&index=0&id=0dd8dfe4&scoped=true&lang=css\"\n\nimport exportComponent from \"/home/andrew-dev/Projects/HIS-Core/node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-0dd8dfe4\"]])\n\nexport default __exports__","import { toDisplayString as _toDisplayString, createTextVNode as _createTextVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, createVNode as _createVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createBlock as _createBlock, createCommentVNode as _createCommentVNode, withScopeId as _withScopeId } from \"vue\"\nconst _withId = /*#__PURE__*/_withScopeId(\"data-v-5bd3374e\")\n\nexport const render = /*#__PURE__*/_withId(function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_ion_label = _resolveComponent(\"ion-label\")\n  const _component_ion_item = _resolveComponent(\"ion-item\")\n  const _component_ion_list = _resolveComponent(\"ion-list\")\n  const _component_ion_col = _resolveComponent(\"ion-col\")\n  const _component_his_keyboard = _resolveComponent(\"his-keyboard\")\n  const _component_ion_row = _resolveComponent(\"ion-row\")\n\n  return (_openBlock(), _createBlock(_component_ion_row, { class: \"ion-margin-vertical border\" }, {\n    default: _withId(() => [\n      _createVNode(_component_ion_col, { size: \"4\" }, {\n        default: _withId(() => [\n          _createVNode(_component_ion_list, null, {\n            default: _withId(() => [\n              _createVNode(_component_ion_item, null, {\n                default: _withId(() => [\n                  _createVNode(_component_ion_label, null, {\n                    default: _withId(() => [\n                      _createTextVNode(_toDisplayString(_ctx.title), 1 /* TEXT */)\n                    ]),\n                    _: 1\n                  })\n                ]),\n                _: 1\n              }),\n              (_openBlock(true), _createBlock(_Fragment, null, _renderList(_ctx.ranges, (range, index) => {\n                return (_openBlock(), _createBlock(_component_ion_item, {\n                  key: range,\n                  color: _ctx.activeIndex === index ? 'light': '',\n                  detail: true,\n                  onClick: $event => (_ctx.generateKeypad(range))\n                }, {\n                  default: _withId(() => [\n                    _createVNode(_component_ion_label, null, {\n                      default: _withId(() => [\n                        _createTextVNode(_toDisplayString(range.start + ' - ' + range.end + ' ' + _ctx.unit), 1 /* TEXT */)\n                      ]),\n                      _: 2\n                    }, 1024)\n                  ]),\n                  _: 2\n                }, 1032, [\"color\", \"onClick\"]))\n              }), 128 /* KEYED_FRAGMENT */))\n            ]),\n            _: 1\n          })\n        ]),\n        _: 1\n      }),\n      (_ctx.keyboard)\n        ? (_openBlock(), _createBlock(_component_ion_col, { key: 0 }, {\n            default: _withId(() => [\n              _createVNode(_component_his_keyboard, {\n                kbConfig: _ctx.keyboard,\n                onKeyPress: _ctx.onKeyPress,\n                disabled: false,\n                style: {\"border\":\"0\"}\n              }, null, 8, [\"kbConfig\", \"onKeyPress\"])\n            ]),\n            _: 1\n          }))\n        : _createCommentVNode(\"\", true)\n    ]),\n    _: 1\n  }))\n})","\nimport { defineComponent, onMounted, ref } from 'vue'\nimport HisKeyboard from \"@/components/Keyboard/HisKeyboard.vue\";\nimport { IonRow, IonCol, IonList, IonItem, IonLabel } from \"@ionic/vue\";\n\nexport default defineComponent({\n  props: {\n    unit: {\n      type: String,\n      default: ''\n    },\n    title: {\n      type: String,\n      default: 'Select Numbers'\n    }\n  },\n  components: { \n    HisKeyboard, \n    IonRow, \n    IonCol, \n    IonList, \n    IonItem, \n    IonLabel\n  },\n  emits: ['onValue'],\n  setup(_, { emit }) {\n    const ranges = ref([\n      {start: 1, end: 20},\n      {start: 21, end: 40},\n      {start: 41, end: 60},\n      {start: 61, end: 80}\n    ])\n    const activeIndex = ref(0)\n    const keyboard = ref<Array<any>>()\n    const onKeyPress = (text: any) => emit('onValue', text)\n    const generateKeypad = (range: any) => {\n      const numbers: string[][] = [[]]\n      let row = 0\n      let counter = 0     \n      for (let i = range.start; i <= range.end; i++){\n        if(counter > 4) {\n          ++row\n          numbers[row] = [],\n          counter = 0\n        }\n        numbers[row].push(`${i}`)\n        ++counter\n      }\n      keyboard.value =  [numbers, []]\n      activeIndex.value = ranges.value.findIndex(r => r.start === range.start)\n    }\n    onMounted(() => generateKeypad(ranges.value[0]))\n    return {\n      keyboard,\n      onKeyPress,\n      generateKeypad,\n      ranges,\n      activeIndex,\n    }\n  },\n})\n","import { render } from \"./HisIntervalKeyboard.vue?vue&type=template&id=5bd3374e&scoped=true&ts=true\"\nimport script from \"./HisIntervalKeyboard.vue?vue&type=script&lang=ts\"\nexport * from \"./HisIntervalKeyboard.vue?vue&type=script&lang=ts\"\n\nimport \"./HisIntervalKeyboard.vue?vue&type=style&index=0&id=5bd3374e&scoped=true&lang=css\"\n\nimport exportComponent from \"/home/andrew-dev/Projects/HIS-Core/node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-5bd3374e\"]])\n\nexport default __exports__","\nimport {\n  IonContent,\n  IonButton,\n  IonHeader,\n  IonTitle,\n  IonToolbar,\n  IonLabel,\n  modalController,\n  IonList,\n  IonItem,\n  IonRow,\n} from \"@ionic/vue\";\nimport { computed, defineComponent, PropType, ref} from \"vue\";\nimport { Option } from \"@/components/Forms/FieldInterface\";\nimport FrequencyCard from \"./FrequencyCard.vue\";\nimport IntervalKeyboard from \"@/components/Keyboard/HisIntervalKeyboard.vue\";\nimport { toastWarning } from \"@/utils/Alerts\";\n\nexport default defineComponent({\n  name: \"PrescriptionModal\",\n  props: {\n    prescribedDrugs: {\n      type: Object as PropType<Option[]>, \n      required: true\n    },\n  },\n  setup (props) {\n    const activeIndex = ref(-1)  \n    const drugs = computed(() => props.prescribedDrugs.map(d => {\n      const drug = d.other\n      drug.duration = 0\n      drug.frequency = {\n        morning: false,\n        noon: false,\n        evening: false,\n        night: false,\n      }\n      return drug\n    }))\n    const getFrequencyCount = (frequency: Record<string, boolean>) => {\n      return Object.values(frequency).filter(value => value).length\n    }\n    const instructions = computed(() => {\n      if(activeIndex.value < 0) return ''\n      const drugname = drugs.value[activeIndex.value].name\n      const freq = getFrequencyCount(drugs.value[activeIndex.value].frequency)\n      const duration = drugs.value[activeIndex.value].duration\n      return `${drugname}, ${freq} time(s) a day, for ${duration} day(s)` \n    })\n    const frequencies = computed(() => {\n      if(activeIndex.value < 0) return {}\n      return drugs.value[activeIndex.value].frequency\n    })\n    const setFrequency = (index: string) => {\n      drugs.value[activeIndex.value].frequency[index] = !drugs.value[activeIndex.value].frequency[index]\n    }\n    const setDuration = (text: string) => {\n      drugs.value[activeIndex.value].duration = parseInt(text)\n    }\n    const isComplete = () => {\n      for (const drug of drugs.value) {\n        const freq = getFrequencyCount(drug.frequency)\n        const duration: number = drug.duration\n        if(!freq  || !duration){\n          toastWarning(`complete prescription details for ${drug.name}`)\n          return false\n        }\n      }\n      return true\n    }\n    const savePrescriptions = () => {\n      if(isComplete()) {\n        modalController.dismiss(drugs.value)\n      }\n    }\n    const closeModal = () => modalController.dismiss()\n    return {\n      drugs,\n      activeIndex,\n      instructions,\n      frequencies,\n      closeModal,\n      setFrequency,\n      setDuration,\n      savePrescriptions,\n    }\n  },\n  components: {\n    IonContent,\n    IonButton,\n    IonHeader,\n    IonTitle,\n    IonToolbar,\n    IonLabel,\n    IonList,\n    IonItem,\n    IonRow,\n    FrequencyCard,\n    IntervalKeyboard\n},\n});\n","import { render } from \"./PrescriptionModal.vue?vue&type=template&id=586626f5&scoped=true&ts=true\"\nimport script from \"./PrescriptionModal.vue?vue&type=script&lang=ts\"\nexport * from \"./PrescriptionModal.vue?vue&type=script&lang=ts\"\n\nimport \"./PrescriptionModal.vue?vue&type=style&index=0&id=586626f5&scoped=true&lang=css\"\n\nimport exportComponent from \"/home/andrew-dev/Projects/HIS-Core/node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-586626f5\"]])\n\nexport default __exports__","\nimport { defineComponent} from 'vue'\nimport HisStandardForm from \"@/components/Forms/TouchScreenForm.vue\";\nimport EncounterMixinVue from '@/views/EncounterMixin.vue';\nimport Validation from '@/components/Forms/validations/StandardValidations';\nimport { Field, Option } from '@/components/Forms/FieldInterface';\nimport { FieldType } from '@/components/Forms/BaseFormElements';\nimport { isEmpty } from 'lodash';\nimport { ANTI_MALARIA_DRUGS, DrugPrescriptionService, DRUG_DOSE_FREQUENCIES } from '../../services/drug_prescription_service';\nimport { modalController } from '@ionic/core';\nimport PrescriptionModalVue from '@/apps/OPD/components/PrescriptionModal.vue';\nimport HisDate from \"@/utils/Date\"\nimport { alertConfirmation, toastSuccess, toastWarning } from '@/utils/Alerts';\n\nexport default defineComponent({\n  components: { HisStandardForm },\n  mixins: [EncounterMixinVue],\n  data: () => ({\n    activeField: '',\n    prescriptionService: {} as any,\n    hasMalaria: false,\n    drugOrders: [] as any\n  }),\n  watch: {\n    ready: {\n      async handler(isReady: boolean) {\n        if(isReady){\n          this.prescriptionService = new DrugPrescriptionService(this.patientID, this.providerID)\n          await this.prescriptionService.loadDrugs()    \n          this.hasMalaria = await this.prescriptionService.hasMalaria()\n          this.fields = this.getFields()\n        }\n      },\n      immediate: true,\n      deep: true\n    }\n  },\n  methods: {\n    async onSubmit(){   \n      const encounter = await this.prescriptionService.createEncounter()\n      if (!encounter) return toastWarning('Unable to create treatment encounter')   \n      const drugOrder = await this.prescriptionService.createDrugOrder(this.drugOrders);\n      if(!drugOrder) return toastWarning('Unable to create drug orders!')\n      toastSuccess('Drug order has been created')\n      this.nextTask()       \n    },\n    async getPrescriptionDetails(prescribedDrugs: Option[]) {\n      const modal = await modalController.create({\n        component: PrescriptionModalVue,\n        backdropDismiss: false,\n        cssClass: \"large-modal\",\n        componentProps: {\n          prescribedDrugs\n        }\n      });\n      modal.present();\n      const { data } = await modal.onDidDismiss();\n      return data\n    },\n    getFrequencyCount(frequency: Record<string, boolean>) {\n      return Object.values(frequency).filter(value => value).length\n    },\n    calculateExpireDate(startDate: string | Date, duration: number ) {\n      const date = new Date(startDate)\n      date.setDate(date.getDate() + duration)\n      return HisDate.toStandardHisFormat(date)\n    },\n    mapToOrders(prescriptions: any[]): any[] {\n      return prescriptions.map(drug => {\n        const startDate = DrugPrescriptionService.getSessionDate()\n        const frequencyCount = (typeof drug.frequency === 'number') ? drug.frequency :  this.getFrequencyCount(drug.frequency)\n        const frequency = DRUG_DOSE_FREQUENCIES[frequencyCount]\n        return {\n          'drug_inventory_id': drug.drug_id,\n          'equivalent_daily_dose': drug.dose_strength * frequencyCount,\n          'start_date': startDate,\n          'auto_expire_date': this.calculateExpireDate(startDate, drug.duration), \n          'units': drug.units,\n          'instructions': `${drug.name}: ${frequencyCount} ${frequency} for ${drug.duration}`,\n          'dose': drug.dose_strength,\n          'frequency': frequency\n        }\n      })\n    },\n    getFields(): Array<Field>{\n      return [\n        {\n          id: 'drugs',\n          helpText: 'Select drugs',\n          type: FieldType.TT_MULTIPLE_SELECT,\n          validation: (data: any) => Validation.required(data),\n          options: () => this.prescriptionService.getDrugOptions(),\n          onload: () => this.activeField = '',\n          beforeNext: async (data: Option[]) => {\n            const prescriptions = await this.getPrescriptionDetails(data)\n            if(isEmpty(prescriptions)) return false\n            this.drugOrders = this.mapToOrders(prescriptions)\n            return true\n          },\n          config: {\n            showKeyboard: true,\n            footerBtns: [\n              {\n                name: 'Predefined Malaria Drugs',\n                color: 'primary',\n                size: 'large',\n                visible: false,\n                slot: 'end',\n                onClick: async () => {\n                  if(this.hasMalaria) this.activeField = 'malaria_drugs'\n                  const ok = await alertConfirmation('Patient has no malaria. Do you still want to prescribe anti malaria drugs?')\n                  if(ok) this.activeField = 'malaria_drugs'\n                }\n              },\n            ]\n          }\n        },\n        {\n          id: 'malaria_drugs',\n          helpText: \"select Malaria Drugs\",\n          validation: (data: any) => Validation.required(data),\n          type: FieldType.TT_SELECT,\n          condition: () => this.activeField === 'malaria_drugs',\n          onValue: (data: Option) => {\n            if(isEmpty(data)) return false\n            this.drugOrders = this.mapToOrders([data.other])\n            return true\n          },\n          options: () => ANTI_MALARIA_DRUGS.map(drug => ({\n            label: `${drug.name}, ${drug.frequency} time(s) a day, for ${drug.duration} days`,\n            value: drug.name,\n            other: drug\n          }))\n        }\n      ]\n    }\n  }\n})\n","import { render } from \"./Prescription.vue?vue&type=template&id=7d9a3f5c&ts=true\"\nimport script from \"./Prescription.vue?vue&type=script&lang=ts\"\nexport * from \"./Prescription.vue?vue&type=script&lang=ts\"\n\nimport exportComponent from \"/home/andrew-dev/Projects/HIS-Core/node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--0-1!./FrequencyCard.vue?vue&type=style&index=0&id=0dd8dfe4&scoped=true&lang=css\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--0-1!./HisIntervalKeyboard.vue?vue&type=style&index=0&id=5bd3374e&scoped=true&lang=css\"","export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--0-1!./PrescriptionModal.vue?vue&type=style&index=0&id=586626f5&scoped=true&lang=css\""],"sourceRoot":""}