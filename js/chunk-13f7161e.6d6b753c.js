(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-13f7161e"],{"12f0":function(e,t,a){"use strict";a.r(t);var n=a("7a23");function r(e,t,a,r,o,i){var c=Object(n["resolveComponent"])("information-header"),u=Object(n["resolveComponent"])("report-table"),l=Object(n["resolveComponent"])("preloader"),s=Object(n["resolveComponent"])("pagination"),d=Object(n["resolveComponent"])("ion-content"),b=Object(n["resolveComponent"])("his-footer"),p=Object(n["resolveComponent"])("ion-page");return Object(n["openBlock"])(),Object(n["createBlock"])(p,{style:{background:"#fff"}},{default:Object(n["withCtx"])((function(){return[Object(n["createVNode"])(c,{items:e.patientCardInfo,numberOfColumns:4,onAddGuardian:e.addGuardian,onUpdate:e.updateDemographics,onUpdateARVNumber:e.updateARVNumber},null,8,["items","onAddGuardian","onUpdate","onUpdateARVNumber"]),Object(n["createVNode"])(d,null,{default:Object(n["withCtx"])((function(){return[Object(n["createVNode"])(u,{paginated:!0,rows:e.rows,columns:e.columns,rowsPerPage:e.itemsPerPage,newPage:e.currentPage,asyncRowParser:e.onNewRow,onOnPagination:t[1]||(t[1]=function(t){return e.totalPages=t.length})},null,8,["rows","columns","rowsPerPage","newPage","asyncRowParser"]),e.visitDatesInitialised?Object(n["createCommentVNode"])("",!0):(Object(n["openBlock"])(),Object(n["createBlock"])(l,{key:0,itemCount:5})),Object(n["createVNode"])(s,{perPage:e.itemsPerPage,maxVisibleButtons:20,totalPages:e.totalPages,onOnChangePage:t[2]||(t[2]=function(t){return e.currentPage=t})},null,8,["perPage","totalPages"])]})),_:1}),Object(n["createVNode"])(b,{btns:e.btns},null,8,["btns"])]})),_:1})}var o=a("2909"),i=a("3835"),c=a("b85c"),u=a("1da1"),l=(a("96cf"),a("d81d"),a("3ca3"),a("ddb0"),a("a15b"),a("99af"),a("b0c0"),a("ac1f"),a("466d"),a("caad"),a("2532"),a("d3b7"),a("25f0"),a("9283")),s=a("23e6"),d=a("7957"),b=Object(n["withScopeId"])("data-v-94355f20");Object(n["pushScopeId"])("data-v-94355f20");var p={style:{padding:".1rem"}},f={style:{width:"100%",display:"flex",justifyContent:"space-between",fontSize:"12px",margin:0,padding:0}};Object(n["popScopeId"])();var m=b((function(e,t,a,r,o,i){var c=Object(n["resolveComponent"])("ion-item"),u=Object(n["resolveComponent"])("ion-list"),l=Object(n["resolveComponent"])("multi-column-view");return Object(n["openBlock"])(),Object(n["createBlock"])("div",p,[Object(n["createVNode"])(l,{items:e.items,numberOfColumns:e.numberOfColumns},{default:b((function(t){var a=t.entries;return[Object(n["createVNode"])(u,null,{default:b((function(){return[(Object(n["openBlock"])(!0),Object(n["createBlock"])(n["Fragment"],null,Object(n["renderList"])(a,(function(t){return Object(n["openBlock"])(),Object(n["createBlock"])(c,{key:t.label,style:{padding:"0 !important",margin:"0 !important"}},{default:b((function(){return[Object(n["createVNode"])("div",f,[Object(n["createVNode"])("span",null,Object(n["toDisplayString"])(t.label)+": ",1),t.other&&t.other.editable?(Object(n["openBlock"])(),Object(n["createBlock"])("span",{key:0,onClick:function(a){return e.onClick(t)}},[Object(n["createVNode"])("a",null,[Object(n["createVNode"])("b",null,Object(n["toDisplayString"])(t.value),1)])],8,["onClick"])):(Object(n["openBlock"])(),Object(n["createBlock"])("b",{key:1,innerHTML:t.value||"N/A"},null,8,["innerHTML"]))])]})),_:2},1024)})),128))]})),_:2},1024)]})),_:1},8,["items","numberOfColumns"])])})),g=(a("a9e3"),a("92c1")),v=Object(n["defineComponent"])({name:"InformationHeader",components:{MultiColumnView:g["a"]},props:{icon:{required:!1},items:{type:Object,required:!0},numberOfColumns:{type:Number,default:2}},emits:["update","updateARVNumber","addGuardian"],setup:function(e,t){var a=t.emit,n=function(e){return"demographics"===e.other.category?a("update",e.other.attribute):"arv_number"===e.other.category?a("updateARVNumber"):a("addGuardian")};return{onClick:n}}}),h=(a("8945"),a("6b0d")),O=a.n(h);const j=O()(v,[["render",m],["__scopeId","data-v-94355f20"]]);var V=j,y=a("0f25"),C=a("2ef0"),w=a("8a30"),I=a("7def"),P=a("b5e4"),k=a("ad60"),x=a("4db7"),N=a("8e8b"),T=a("80e3"),B=a("9ceb"),_=a("1799"),R=a("ded6");const D=Object(n["createTextVNode"])(" Close ");function S(e,t,a,r,o,i){const c=Object(n["resolveComponent"])("ion-title"),u=Object(n["resolveComponent"])("ion-toolbar"),l=Object(n["resolveComponent"])("ion-header"),s=Object(n["resolveComponent"])("information-header"),d=Object(n["resolveComponent"])("ion-content"),b=Object(n["resolveComponent"])("ion-button"),p=Object(n["resolveComponent"])("ion-footer");return Object(n["openBlock"])(),Object(n["createBlock"])(n["Fragment"],null,[Object(n["createVNode"])(l,null,{default:Object(n["withCtx"])(()=>[Object(n["createVNode"])(u,null,{default:Object(n["withCtx"])(()=>[Object(n["createVNode"])(c,null,{default:Object(n["withCtx"])(()=>[Object(n["createTextVNode"])(Object(n["toDisplayString"])(e.title),1)]),_:1})]),_:1})]),_:1}),Object(n["createVNode"])(d,null,{default:Object(n["withCtx"])(()=>[Object(n["createVNode"])(s,{items:e.visitData},null,8,["items"])]),_:1}),Object(n["createVNode"])(p,null,{default:Object(n["withCtx"])(()=>[Object(n["createVNode"])(u,null,{default:Object(n["withCtx"])(()=>[Object(n["createVNode"])(b,{onClick:e.closeModal,slot:"end"},{default:Object(n["withCtx"])(()=>[D]),_:1},8,["onClick"])]),_:1})]),_:1})],64)}var A=Object(n["defineComponent"])({components:{InformationHeader:V},props:{title:{type:String,required:!0},visitData:{type:Object,required:!0}},methods:{async closeModal(){await w["X"].dismiss({})}}});const F=O()(A,[["render",S]]);var H=F,E=Object(n["defineComponent"])({components:{Preloader:R["a"],Pagination:_["a"],IonPage:w["D"],ReportTable:T["a"],IonContent:w["n"],HisFooter:y["a"],InformationHeader:V},data:function(){return{patientId:0,patient:{},patientCardInfo:[],btns:[],itemsPerPage:10,currentPage:0,totalPages:0,pages:[],visitDates:[],tbStats:[],visitDatesInitialised:!1,columns:[[B["a"].thTxt("VISIT DATE"),B["a"].thTxt("WEIGHT (Kg)"),B["a"].thTxt("REG"),B["a"].thTxt("VIRAL LOAD"),B["a"].thTxt("TB STATUS"),B["a"].thTxt("OUTCOME"),B["a"].thTxt("PILLS DISPENSED"),B["a"].thTxt("ACTIONS")]],rows:[]}},created:function(){var e=this;this.setPatientCards(),this.patientId=parseInt("".concat(this.$route.params.patient_id)),s["a"].getPatientVisits(this.patientId,!0).then((function(t){e.visitDatesInitialised=!0,e.visitDates=t,e.rows=t.map((function(t){return[B["a"].tdBtn(l["b"].toStandardHisDisplayFormat(t),(function(){return new x["a"](e.patientId).printVisitSummaryLbl(t)})),B["a"].td("..."),B["a"].td("..."),B["a"].td("..."),B["a"].td("..."),B["a"].td("..."),B["a"].td("..."),B["a"].td("...")]}))})).catch((function(t){e.visitDatesInitialised=!0,Object(P["c"])("".concat(t)),console.error(t)})),this.btns.push({name:"Finish",color:"success",size:"large",slot:"end",visible:!0,onClick:function(){Object(P["a"])("Are you sure you want to exit?").then((function(t){if(t)return e.$router.push("/patient/dashboard/".concat(e.patientId))}))}})},mounted:function(){var e=this;return Object(u["a"])(regeneratorRuntime.mark((function t(){var a,n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.patientId){t.next=17;break}a=Object(c["a"])(e.patientCardInfo),t.prev=2,r=regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=n.value,"function"!==typeof t.init){e.next=4;break}return e.next=4,t.init();case 4:"function"===typeof t.asyncValue?t.asyncValue(t).then((function(e){return t.value=e||""})):"function"===typeof t.staticValue&&(t.value=t.staticValue());case 5:case"end":return e.stop()}}),e)})),a.s();case 5:if((n=a.n()).done){t.next=9;break}return t.delegateYield(r(),"t0",7);case 7:t.next=5;break;case 9:t.next=14;break;case 11:t.prev=11,t.t1=t["catch"](2),a.e(t.t1);case 14:return t.prev=14,a.f(),t.finish(14);case 17:case"end":return t.stop()}}),t,null,[[2,11,14,17]])})))()},methods:{setPatientCards:function(){var e=this;this.patientCardInfo=[{label:"ARV Number",value:"...",staticValue:function(){return e.patient.getArvNumber()},init:function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,N["a"].get("ACTIVE_PATIENT",{patientID:e.patientId});case 2:e.patient=t.sent;case 3:case"end":return t.stop()}}),t)})));function a(){return t.apply(this,arguments)}return a}(),other:{editable:!0,category:"arv_number"}},{label:"National Patient ID",value:"...",staticValue:function(){return e.patient.getNationalID()}},{label:"Given Name",value:"...",staticValue:function(){return e.patient.getGivenName()},other:{editable:!0,attribute:"given_name",category:"demographics"}},{label:"Family Name",value:"...",staticValue:function(){return e.patient.getFamilyName()},other:{editable:!0,attribute:"family_name",category:"demographics"}},{label:"Age",value:"...",staticValue:function(){return e.patient.getAge()},other:{editable:!0,attribute:"year_birth_date",category:"demographics"}},{label:"Sex",value:"...",staticValue:function(){return e.patient.getGender()},other:{editable:!0,attribute:"gender",category:"demographics"}},{label:"Location",value:"...",staticValue:function(){return e.patient.getCurrentVillage()},other:{editable:!0,attribute:"home_region",category:"demographics"}},{label:"Landmark",value:"...",staticValue:function(){return e.patient.getAttribute(19)}},{label:"Guardian",value:"...",asyncValue:function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(a){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,I["a"].getGuardianDetails(e.patientId);case 2:if(n=t.sent,!Object(C["isEmpty"])(n)){t.next=6;break}return a.other.editable=!0,t.abrupt("return","add");case 6:return t.abrupt("return",n.map((function(e){return" ".concat(e.name," (").concat(e.relationshipType,")")})).join(" "));case 7:case"end":return t.stop()}}),t)})));function a(e){return t.apply(this,arguments)}return a}(),other:{editable:!1,attribute:"",category:"guardian"}},{label:"Init W(KG)",value:"...",asyncValue:function(){return e.patient.getInitialWeight()}},{label:"Init H(CM)",value:"...",asyncValue:function(){return e.patient.getInitialHeight()}},{label:"BMI(CM)",value:"...",asyncValue:function(){return e.patient.getInitialBMI()}},{label:"TI",value:"...",asyncValue:function(){return d["a"].getFirstValueCoded(e.patientId,"Ever received ART")}},{label:"Agrees to follow up",value:"...",asyncValue:function(){return d["a"].getFirstValueCoded(e.patientId,"Agrees to followup")}},{label:"Reason for starting ART",value:"...",asyncValue:function(){return d["a"].getFirstValueCoded(e.patientId,"Reason for ART eligibility")}},{label:"HIV test date",value:"...",asyncValue:function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,d["a"].getFirstValueDatetime(e.patientId,"Confirmatory HIV test date");case 2:return a=t.sent,t.abrupt("return",a?l["b"].toStandardHisDisplayFormat(a):"");case 4:case"end":return t.stop()}}),t)})));function a(){return t.apply(this,arguments)}return a}()},{label:"HIV test place",value:"...",asyncValue:function(){return d["a"].getFirstValueText(e.patientId,"Confirmatory HIV test location")}},{label:"Date of starting first line ART",value:"...",asyncValue:function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,d["a"].getFirstValueDatetime(e.patientId,"Date ART started");case 2:return a=t.sent,t.abrupt("return",a?l["b"].toStandardHisDisplayFormat(a):"");case 4:case"end":return t.stop()}}),t)})));function a(){return t.apply(this,arguments)}return a}()},{label:"Pulmonary TB within the last 2 years",value:"...",init:function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,d["a"].getAllValueCoded(e.patientId,"Who stages criteria present");case 2:if(t.t0=t.sent,t.t0){t.next=5;break}t.t0=[];case 5:e.tbStats=t.t0;case 6:case"end":return t.stop()}}),t)})));function a(){return t.apply(this,arguments)}return a}(),staticValue:function(){return e.hasTbStat("Tuberculosis (PTB or EPTB) within the last 2 years")}},{label:"Extra pulmonary TB (EPTB)",value:"...",staticValue:function(){return e.hasTbStat("Extrapulmonary tuberculosis (EPTB)")}},{label:"Pulmonary TB (current)",value:"...",staticValue:function(){return e.hasTbStat("Pulmonary tuberculosis (current)")}},{label:"Kaposis sarcoma",value:"...",staticValue:function(){return e.hasTbStat("Kaposis sarcoma")}}]},buildDetails:function(e){var t=function(e){return e.map((function(e){var t=Object(i["a"])(e,2),a=t[0],n=t[1];return"".concat(a," (").concat(n,")")})).join("/")};return[{label:"Outcome",value:e.outcome},{label:"Outcome Date",value:e.outcome_date},{label:"Side effects",value:e.side_effects},{label:"Viral load",value:e.viral_load},{label:"Pills Brought",value:t(e.pills_brought)},{label:"Pills dispensed",value:t(e.pills_dispensed)},{label:"Visit by",value:e.visit_by},{label:"Regimen",value:e.regimen},{label:"Adherence",value:t(e.adherence)},{label:"TB Status",value:e.tb_status},{label:"Height (cm)",value:e.height},{label:"Weight (Kg)",value:e.weight},{label:"BMI",value:e.bmi}]},onNewRow:function(e){var t=this;return Object(u["a"])(regeneratorRuntime.mark((function a(){var n,r,i,c,l;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(n=Object(o["a"])(e),!n[1]||"..."==n[1].td){a.next=3;break}return a.abrupt("return",n);case 3:return r=n[0].td,a.next=6,k["a"].getCurrentProgramInformation(t.patientId,r);case 6:return i=a.sent,a.next=9,k["a"].getMastercardDrugInformation(t.patientId,r);case 9:return c=a.sent,l=((null===c||void 0===c?void 0:c.pills_given)||[]).map((function(e){return"".concat(e["short_name"]||e["name"]," <b>(").concat(e.quantity||"?",")</b>")})).join("<br/>"),n[1]=B["a"].td(i.weight),n[2]=B["a"].td(i.regimen),n[3]=B["a"].td(i.viral_load),n[4]=B["a"].td(i.tb_status),n[5]=B["a"].td(i.outcome.match(/Unk/i)?"Unknown":i.outcome),n[6]=B["a"].td(l),n[7]=B["a"].tdBtn("More",Object(u["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,w["X"].create({component:H,backdropDismiss:!1,cssClass:"large-modal",componentProps:{title:r,visitData:t.buildDetails(i)}});case 2:e.sent.present();case 3:case"end":return e.stop()}}),e)})))),a.abrupt("return",n);case 19:case"end":return a.stop()}}),a)})))()},hasTbStat:function(e){return this.tbStats.includes(e)?"Yes":"No"},updateDemographics:function(e){this.$router.push({path:"/patient/registration",query:{edit_person:this.patientId,person_attribute:e}})},addGuardian:function(){var e;this.$router.push({path:"/guardian/registration/".concat(this.patientId),query:{source:null===(e=this.$route.name)||void 0===e?void 0:e.toString()}})},updateARVNumber:function(){this.$router.push({name:"Edit ARV Number"})}}});const L=O()(E,[["render",r]]);t["default"]=L},1799:function(e,t,a){"use strict";a("b0c0");var n=a("7a23"),r=Object(n["withScopeId"])("data-v-04a5a269");Object(n["pushScopeId"])("data-v-04a5a269");var o={class:"pagination"},i={class:"btn-group"},c=Object(n["createTextVNode"])(" First "),u=Object(n["createTextVNode"])(" Last ");Object(n["popScopeId"])();var l=r((function(e,t,a,l,s,d){var b=Object(n["resolveComponent"])("ion-button"),p=Object(n["resolveComponent"])("ion-icon");return Object(n["openBlock"])(),Object(n["createBlock"])("div",o,[Object(n["createVNode"])("div",i,[Object(n["createVNode"])(b,{color:"light",onClick:e.setFirstPage,disabled:e.isInFirstPage},{default:r((function(){return[c]})),_:1},8,["onClick","disabled"]),Object(n["createVNode"])(b,{color:"light",onClick:e.prevPage},{default:r((function(){return[Object(n["createVNode"])(p,{icon:e.caretBack},null,8,["icon"])]})),_:1},8,["onClick"]),(Object(n["openBlock"])(!0),Object(n["createBlock"])(n["Fragment"],null,Object(n["renderList"])(e.pages,(function(e){return Object(n["openBlock"])(),Object(n["createBlock"])(b,{onClick:function(t){return e.show()},color:e.isActive?"primary":"light",key:e.index},{default:r((function(){return[Object(n["createTextVNode"])(Object(n["toDisplayString"])(e.name),1)]})),_:2},1032,["onClick","color"])})),128)),Object(n["createVNode"])(b,{color:"light",onClick:e.nextPage},{default:r((function(){return[Object(n["createVNode"])(p,{icon:e.caretForward},null,8,["icon"])]})),_:1},8,["onClick"]),Object(n["createVNode"])(b,{color:"light",onClick:e.setLastPage,disabled:e.isInLastPage},{default:r((function(){return[u]})),_:1},8,["onClick","disabled"])]),Object(n["createVNode"])("h6",null,"Page "+Object(n["toDisplayString"])(e.currentPage+1)+" of "+Object(n["toDisplayString"])(e.totalPages),1)])})),s=(a("a9e3"),a("ff79")),d=a("8a30"),b=Object(n["defineComponent"])({components:{IonIcon:d["r"],IonButton:d["d"]},props:{maxVisibleButtons:{type:Number,required:!1,default:3},totalPages:{type:Number,required:!0}},emits:["onChangePage"],setup:function(e,t){var a=t.emit,r=Object(n["ref"])(0),o=Object(n["computed"])((function(){return 0===r.value})),i=Object(n["computed"])((function(){return r.value===e.totalPages})),c=Object(n["computed"])((function(){return 0===r.value?0:r.value===e.totalPages?e.totalPages-e.maxVisibleButtons:r.value-1})),u=function(e){return a("onChangePage",e)},l=Object(n["computed"])((function(){for(var t=[],a=function(e){t.push({index:e,name:e+1,show:function(){return r.value=e},isActive:e===r.value})},n=c.value;n<=Math.min(c.value+e.maxVisibleButtons-1,e.totalPages-1);n++)a(n);return t}));Object(n["watch"])(e,(function(e){var t=e.totalPages;"number"===typeof t&&(r.value=0)}),{immediate:!0,deep:!0}),Object(n["watch"])(r,(function(e){return u(e)}));var d=function(){return r.value=0},b=function(){return r.value=e.totalPages-1},p=function(){r.value>0&&(r.value-=1)},f=function(){r.value+1<e.totalPages&&(r.value+=1)};return{currentPage:r,caretBack:s["k"],caretForward:s["m"],startPage:c,pages:l,isInFirstPage:o,isInLastPage:i,nextPage:f,prevPage:p,setPage:u,setFirstPage:d,setLastPage:b}}}),p=(a("f099"),a("6b0d")),f=a.n(p);const m=f()(b,[["render",l],["__scopeId","data-v-04a5a269"]]);t["a"]=m},"3aa1":function(e,t,a){},"5a7d":function(e,t,a){},8945:function(e,t,a){"use strict";a("5a7d")},f099:function(e,t,a){"use strict";a("3aa1")}}]);
//# sourceMappingURL=chunk-13f7161e.6d6b753c.js.map