(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["TouchFormElement38","TouchFormElement51"],{"0a79":function(e,t,o){"use strict";var a=o("7a23"),c=Object(a["withScopeId"])("data-v-7c293cad"),i=c((function(e,t,o,c,i,n){return Object(a["openBlock"])(),Object(a["createBlock"])("div",{id:"view-port",class:e.showFull?"":"half"},[Object(a["renderSlot"])(e.$slots,"default")],2)})),n=Object(a["defineComponent"])({name:"ViewPort",props:{showFull:{type:Boolean,default:function(){return!0}}}}),s=(o("a4d3"),o("6b0d")),r=o.n(s);const l=r()(n,[["render",i],["__scopeId","data-v-7c293cad"]]);t["a"]=l},"1b20":function(e,t,o){},"97ed":function(e,t,o){"use strict";o.d(t,"a",(function(){return l}));var a=o("cc6f"),c=o("8158"),i=o("b89f"),n=o("1c74"),s=o("2ef0"),r=o("9283");class l extends a["a"]{constructor(e,t){super(e,121,t)}static async getRadiologyList(e,t=""){return c["a"].getConceptSet(e,t)}async getRadiologyObs(e){try{const t="radiology/radiology_orders?patient_id="+e,o=await n["e"].getJson(t);return o}catch(t){return 0}}async showPreviousRadiolgy(e){return(await this.getRadiologyObs(e.getID())).length>0}async getPreviousRadiologyExaminations(e){const t=await n["e"].getThirdpartyApps();let o="";for(const c of t)"pacs"==c.name&&(o=c.url);Object(s["isEmpty"])(o)&&(o="opd/encounters/radiology/"+this.patientID);const a=await this.getRadiologyObs(e.getID());return a.length>0&&{data:a,url:o}}async submitToPacs(e,t){let o;for(const n of e)o=n.children[0].accession_number;const a=await Promise.all(e.map(async e=>({main_value_text:e.value_text,obs_id:e.obs_id,sub_value_text:e.children[0].value_text}))),c={patient_name:t.getFullName(),patientAge:t.getAge(),patientDOB:t.getBirthdate(),patientGender:t.getGender(),national_id:t.getNationalID(),person_id:t.getID(),encounter_id:this.getEncounterID(),date_created:this.getDate(),accession_number:o},i={username:n["e"].getUserName(),userID:n["e"].getUserID(),userRoles:n["e"].getUserRoles()};return n["e"].postJson("radiology/radiology_orders",{patient_details:c,physician_details:i,radiology_orders:a})}async getAccesionNumber(){return(await n["e"].getJson("sequences/next_accession_number"))["accession_number"]}async obsObj(e){const t=await this.getAccesionNumber(),o=[];for(const a of e)o.push({concept_id:a.concept_id,value_text:await c["a"].getConceptName(a.child.concept_id),child:{concept_id:a.child.concept_id,accession_number:t,value_text:await c["a"].getConceptName(a.child.value_coded)}});return o}async printOrders(e,t){const o=new i["a"],a=t.getNationalID(),c=t.getFullName(),n=[];for(const i of e){const e=i.value_text+": "+i.children[0].value_text;n.push("/radiology/barcode?accession_number="+i.children[0].accession_number+"&patient_national_id="+a+"&patient_name="+c+"&radio_order="+e+"&date_created="+r["b"].toStandardHisDisplayFormat(i.obs_datetime))}await o.batchPrintLbls(n,!0)}}},a4d3:function(e,t,o){"use strict";o("a6f7")},a6f7:function(e,t,o){},adc7:function(e,t,o){"use strict";o.r(t);var a=o("7a23");const c=Object(a["withScopeId"])("data-v-b17197ee");Object(a["pushScopeId"])("data-v-b17197ee");const i={style:{}};Object(a["popScopeId"])();const n=c((function(e,t,o,n,s,r){const l=Object(a["resolveComponent"])("ion-text"),d=Object(a["resolveComponent"])("ion-label"),u=Object(a["resolveComponent"])("ion-chip"),b=Object(a["resolveComponent"])("ion-col"),h=Object(a["resolveComponent"])("ion-row"),p=Object(a["resolveComponent"])("ion-item"),g=Object(a["resolveComponent"])("ion-list"),O=Object(a["resolveComponent"])("ion-checkbox"),m=Object(a["resolveComponent"])("ion-grid"),y=Object(a["resolveComponent"])("view-port");return Object(a["openBlock"])(),Object(a["createBlock"])("div",null,[Object(a["createVNode"])(y,{showFull:!e.showKeyboard,style:{padding:"0"}},{default:c(()=>[Object(a["createVNode"])(m,null,{default:c(()=>[Object(a["createVNode"])(h,null,{default:c(()=>[Object(a["createVNode"])(b,{size:"12"},{default:c(()=>[(Object(a["openBlock"])(!0),Object(a["createBlock"])(a["Fragment"],null,Object(a["renderList"])(e.checkedItems,(t,o)=>(Object(a["openBlock"])(),Object(a["createBlock"])("span",{key:o},[Object(a["createVNode"])(u,{color:"danger",onClick:o=>e.uncheck(t)},{default:c(()=>[Object(a["createVNode"])(d,null,{default:c(()=>[Object(a["createVNode"])(l,{class:"his-md-text"},{default:c(()=>[Object(a["createTextVNode"])(Object(a["toDisplayString"])(t.label),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"])]))),128))]),_:1})]),_:1}),Object(a["createVNode"])(h,null,{default:c(()=>[Object(a["createVNode"])(b,{size:"4"},{default:c(()=>[Object(a["createVNode"])(g,{style:{overflowY:"auto",height:"80vh",margin:0}},{default:c(()=>[(Object(a["openBlock"])(!0),Object(a["createBlock"])(a["Fragment"],null,Object(a["renderList"])(e.listData,(t,o)=>(Object(a["openBlock"])(),Object(a["createBlock"])(p,{key:o,onClick:o=>e.getSpecificRadiologyOrders(t.value),detail:!0,color:e.ActiveCategory===t.label?"lightblue":""},{default:c(()=>[Object(a["createVNode"])(d,null,{default:c(()=>[Object(a["createVNode"])(l,{class:"his-md-text"},{default:c(()=>[Object(a["createTextVNode"])(Object(a["toDisplayString"])(t.label),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick","color"]))),128))]),_:1})]),_:1}),e.ActiveCategory?(Object(a["openBlock"])(),Object(a["createBlock"])(b,{key:0,style:{overflowY:"auto",height:"78vh"}},{default:c(()=>[Object(a["createVNode"])("div",i,[Object(a["createVNode"])(g,{class:"view-port-content"},{default:c(()=>[(Object(a["openBlock"])(!0),Object(a["createBlock"])(a["Fragment"],null,Object(a["renderList"])(e.activeCategoryItems,(t,o)=>(Object(a["openBlock"])(),Object(a["createBlock"])(p,{key:o,color:t.isChecked?"lightblue":""},{default:c(()=>[Object(a["createVNode"])(d,null,{default:c(()=>[Object(a["createVNode"])(l,{class:"his-md-text"},{default:c(()=>[Object(a["createTextVNode"])(Object(a["toDisplayString"])(t.label),1)]),_:2},1024)]),_:2},1024),Object(a["createVNode"])(O,{slot:"end",modelValue:t.isChecked,"onUpdate:modelValue":e=>t.isChecked=e,onIonChange:o=>e.onselect(t,o),disabled:null===t||void 0===t?void 0:t.disabled},null,8,["modelValue","onUpdate:modelValue","onIonChange","disabled"])]),_:2},1032,["color"]))),128))]),_:1})])]),_:1})):Object(a["createCommentVNode"])("",!0)]),_:1})]),_:1})]),_:1},8,["showFull"])])}));var s=o("8a30"),r=o("82a9"),l=o("97ed"),d=o("2ef0"),u=Object(a["defineComponent"])({components:{IonCheckbox:s["k"],IonText:s["M"],IonChip:s["l"]},name:"HisRadiologyPicker",mixins:[r["default"]],data:()=>({radiologyOrdersList:{},ActiveCategory:""}),methods:{async init(){this.$emit("onFieldActivated",this);const e=await l["a"].getRadiologyList("Radiology Orders");this.listData=this.mapListToOptions(e),this.$emit("onValue",this.getChecked(this.radiologyOrdersList))},async onselect(e,t){this.$nextTick(async()=>{const o={...e};if(o.isChecked=t.target.checked,this.onValue&&o.isChecked){const e=await this.onValue(o);if(!e)return t.target.checked=!1}this.onValueUpdate&&(this.radiologyOrdersList=await this.onValueUpdate({...this.radiologyOrdersList},o)),this.$emit("onValue",this.getChecked(this.radiologyOrdersList))})},async getSpecificRadiologyOrders(e){if(!(e in this.radiologyOrdersList)){const t=await l["a"].getRadiologyList(e);this.radiologyOrdersList[e]=this.mapListToOptions(t,e)}this.ActiveCategory=e},mapListToOptions(e,t=""){return Object(d["isEmpty"])(e)?[]:e.map(e=>{const o={label:e.name,value:e.name,isChecked:!1,other:e};return t&&(o.other.parent=t),o})},uncheck(e){this.radiologyOrdersList[e.other.parent].forEach(t=>{t.label===e.label&&(t.isChecked=!1)})},getChecked(e){const t=[];for(const o in e)t.push(...e[o].filter(e=>e.isChecked));return t}},computed:{checkedItems(){return this.getChecked(this.radiologyOrdersList)},activeCategoryItems(){return this.radiologyOrdersList[this.ActiveCategory]}},watch:{clear(){for(const e in this.radiologyOrdersList)this.radiologyOrdersList[e]=this.radiologyOrdersList[e].map(e=>(e.isChecked=!1,e))}},mounted(){this.init()},activated(){this.init()}}),b=(o("cd14"),o("6b0d")),h=o.n(b);const p=h()(u,[["render",n],["__scopeId","data-v-b17197ee"]]);t["default"]=p},cd14:function(e,t,o){"use strict";o("1b20")}}]);
//# sourceMappingURL=TouchFormElement38.7a893a87.js.map