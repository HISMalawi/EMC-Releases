(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0d24d27e"],{"313e":function(e,t,n){"use strict";n.r(t);n("b64b"),n("a4d30"),n("e01a");var o=n("7a23"),c=Object(o["withScopeId"])("data-v-7217b18a");Object(o["pushScopeId"])("data-v-7217b18a");var r=Object(o["createVNode"])("label",{class:"his-title"}," Prescribe BP drugs ",-1),a={key:0,class:"view-port-content"},i={id:"main-table",style:{width:"100%"}},l=Object(o["createVNode"])("th",null," ",-1),s=Object(o["createVNode"])("td",{class:"td-remaining td-title"},[Object(o["createVNode"])("span",null,"New/Current")],-1),u=Object(o["createVNode"])("td",{class:"td-remaining td-title"},[Object(o["createVNode"])("span",null," ")],-1),d=Object(o["createTextVNode"])(" Add notes "),b=Object(o["createVNode"])("p",null,null,-1),O={id:"table-notes",style:{width:"100%"}},j=Object(o["createVNode"])("caption",{style:{"font-size":"1.2em"}}," Notes ",-1),p=Object(o["createVNode"])("p",null,null,-1),f={class:"table-inner-notes",id:"notes-HCZ"},g={class:"date-td today-td"},m={class:"date-td today-td"},h=Object(o["createTextVNode"])(" X "),k=Object(o["createTextVNode"])(" cancel "),N=Object(o["createTextVNode"])(" Clear Session Prescription "),v=Object(o["createTextVNode"])(" Continue ");Object(o["popScopeId"])();var C=c((function(e,t,n,C,V,B){var w=Object(o["resolveComponent"])("ion-col"),y=Object(o["resolveComponent"])("ion-row"),x=Object(o["resolveComponent"])("ion-toolbar"),D=Object(o["resolveComponent"])("ion-header"),I=Object(o["resolveComponent"])("ion-checkbox"),F=Object(o["resolveComponent"])("ion-button"),_=Object(o["resolveComponent"])("view-port"),T=Object(o["resolveComponent"])("ion-content"),S=Object(o["resolveComponent"])("ion-footer"),P=Object(o["resolveComponent"])("ion-page");return Object(o["openBlock"])(),Object(o["createBlock"])(P,null,{default:c((function(){return[Object(o["createVNode"])(D,null,{default:c((function(){return[Object(o["createVNode"])(x,null,{default:c((function(){return[Object(o["createVNode"])(y,null,{default:c((function(){return[Object(o["createVNode"])(w,null,{default:c((function(){return[r]})),_:1})]})),_:1})]})),_:1})]})),_:1}),Object(o["createVNode"])(T,null,{default:c((function(){return[Object(o["createVNode"])(_,null,{default:c((function(){return[e.drugs?(Object(o["openBlock"])(),Object(o["createBlock"])("div",a,[Object(o["createVNode"])("table",i,[Object(o["createVNode"])("tr",null,[l,(Object(o["openBlock"])(!0),Object(o["createBlock"])(o["Fragment"],null,Object(o["renderList"])(e.drugs,(function(e,t){return Object(o["openBlock"])(),Object(o["createBlock"])("th",{key:t},[Object(o["createTextVNode"])(Object(o["toDisplayString"])(t)+" ",1),Object(o["createVNode"])(y,null,{default:c((function(){return[(Object(o["openBlock"])(!0),Object(o["createBlock"])(o["Fragment"],null,Object(o["renderList"])(e.drugs,(function(e,t){return Object(o["openBlock"])(),Object(o["createBlock"])(w,{class:"col-borders",key:t},{default:c((function(){return[Object(o["createTextVNode"])(Object(o["toDisplayString"])(e.amount||"0mg"),1)]})),_:2},1024)})),128))]})),_:2},1024)])})),128))]),Object(o["createVNode"])("tr",null,[s,(Object(o["openBlock"])(!0),Object(o["createBlock"])(o["Fragment"],null,Object(o["renderList"])(e.drugs,(function(t,n){return Object(o["openBlock"])(),Object(o["createBlock"])("td",{key:n,class:"td-current td-value"},[Object(o["createVNode"])(y,null,{default:c((function(){return[(Object(o["openBlock"])(!0),Object(o["createBlock"])(o["Fragment"],null,Object(o["renderList"])(t.drugs,(function(t,r){return Object(o["openBlock"])(),Object(o["createBlock"])(w,{key:r},{default:c((function(){return[Object(o["createVNode"])(I,{checked:t.selected,onIonChange:function(t){return e.selectDrug(n,r,t)}},null,8,["checked","onIonChange"])]})),_:2},1024)})),128))]})),_:2},1024)])})),128))]),Object(o["createVNode"])("tr",null,[u,(Object(o["openBlock"])(!0),Object(o["createBlock"])(o["Fragment"],null,Object(o["renderList"])(Object.keys(e.drugs),(function(t,n){return Object(o["openBlock"])(),Object(o["createBlock"])("td",{class:"td-remaining td-value",key:n},[Object(o["createVNode"])(y,null,{default:c((function(){return[Object(o["createVNode"])(w,null,{default:c((function(){return[Object(o["createVNode"])(F,{onClick:function(n){return e.launchNotePad(t)},color:"warning"},{default:c((function(){return[d]})),_:1},8,["onClick"])]})),_:1})]})),_:1})])})),128))])]),b,Object(o["createVNode"])("table",O,[j,p,Object(o["createVNode"])("tr",null,[(Object(o["openBlock"])(!0),Object(o["createBlock"])(o["Fragment"],null,Object(o["renderList"])(e.drugs,(function(e,t){return Object(o["openBlock"])(),Object(o["createBlock"])("th",{style:{width:"25%"},key:t},[Object(o["createVNode"])("span",null,Object(o["toDisplayString"])(t),1)])})),128))]),Object(o["createVNode"])("tr",null,[(Object(o["openBlock"])(!0),Object(o["createBlock"])(o["Fragment"],null,Object(o["renderList"])(Object.keys(e.drugs),(function(t,n){return Object(o["openBlock"])(),Object(o["createBlock"])("td",{id:"HCZ",style:{"padding-top":"2px !important"},valign:"top",key:n},[Object(o["createVNode"])("table",f,[(Object(o["openBlock"])(!0),Object(o["createBlock"])(o["Fragment"],null,Object(o["renderList"])(e.drugs[t].notes,(function(n,r){return Object(o["openBlock"])(),Object(o["createBlock"])("tr",{key:r},[Object(o["createVNode"])("td",g,Object(o["toDisplayString"])(n.date),1),Object(o["createVNode"])("td",m,Object(o["toDisplayString"])(n.description),1),Object(o["createVNode"])("td",null,[n.isNewNote?(Object(o["openBlock"])(),Object(o["createBlock"])(F,{key:0,color:"danger",onClick:function(n){return e.removeNote(t,r)}},{default:c((function(){return[h]})),_:1},8,["onClick"])):Object(o["createCommentVNode"])("",!0)])])})),128))])])})),128))])])])):Object(o["createCommentVNode"])("",!0)]})),_:1})]})),_:1}),Object(o["createVNode"])(S,null,{default:c((function(){return[Object(o["createVNode"])(x,{color:"dark"},{default:c((function(){return[Object(o["createVNode"])(F,{size:"large",color:"danger",slot:"start",onClick:e.gotoPatientDashboard},{default:c((function(){return[k]})),_:1},8,["onClick"]),e.canClearHtnSessionPrescription?(Object(o["openBlock"])(),Object(o["createBlock"])(F,{key:0,size:"large",color:"warning",slot:"end",onClick:e.clearPrescriptionInSession},{default:c((function(){return[N]})),_:1},8,["onClick"])):Object(o["createCommentVNode"])("",!0),e.selectedDrugs&&e.selectedDrugs.length>0?(Object(o["openBlock"])(),Object(o["createBlock"])(F,{key:1,size:"large",color:"success",slot:"end",onClick:e.onFinish},{default:c((function(){return[v]})),_:1},8,["onClick"])):Object(o["createCommentVNode"])("",!0)]})),_:1})]})),_:1})]})),_:1})})),V=n("1da1"),B=(n("a434"),n("d81d"),n("4de4"),n("d3b7"),n("07ac"),n("99af"),n("3ca3"),n("ddb0"),n("e9c4"),n("159b"),n("96cf"),n("0a79")),w=n("d95e"),y=n("e6e9"),x=n("8a30"),D=n("7365"),I=n("32b3"),F=n("ad60"),_=n("b5e4"),T=n("2ef0"),S=Object(o["defineComponent"])({mixins:[D["a"]],components:{ViewPort:B["a"],IonToolbar:x["Q"],IonHeader:x["q"],IonContent:x["n"],IonRow:x["H"],IonButton:x["d"],IonCol:x["m"],IonFooter:x["o"],IonPage:x["D"],IonCheckbox:x["k"]},watch:{ready:{handler:function(e){var t=this;return Object(V["a"])(regeneratorRuntime.mark((function n(){var o,c,r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(!e){n.next=11;break}return t.HTN=new I["a"](t.patientID,t.providerID),t.drugs=t.HTN.getDrugs(),n.next=5,t.HTN.getCurrentDrugs();case 5:o=n.sent,c=o.drugs,r=o.notes,t.setPreviousBpDrugs(c),t.setPreviousBpNotes(r),t.canClearHtnSessionPrescription=t.patientHasHtnSessionKey();case 11:case"end":return n.stop()}}),n)})))()},immediate:!0}},data:function(){return{HTN:{},drugs:null,canClearHtnSessionPrescription:!1}},methods:{clearPrescriptionInSession:function(){sessionStorage.removeItem(I["b"].Prescription),this.canClearHtnSessionPrescription=!1},patientHasHtnSessionKey:function(){try{var e=sessionStorage.getItem(I["b"].Prescription);if(e){var t=JSON.parse(e);return t[this.patientID]}}catch(n){console.warn(n)}return!1},removeNote:function(e,t,n){this.drugs[e].notes.splice(n,1)},launchNotePad:function(e){var t=this;this.showModal({id:"note",helpText:"Add notes for ".concat(e),type:w["b"].TT_TEXT},(function(n){n&&t.drugs[e].notes.push({date:F["a"].getSessionDate(),description:n.value||"",drugID:t.drugs[e].drugs[0].drugID,isNewNote:!0})}))},onFinish:function(){var e=this;return Object(V["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=Object.values(e.drugs).filter((function(e){return!Object(T["isEmpty"])(e.notes)})).map((function(e){return e.notes})).reduce((function(e,t){return e.concat(t)}),[]).filter((function(e){return e.isNewNote})).map((function(t){return e.HTN.buildObs("Clinician notes",{value_text:t.description,value_drug:t.drugID})})),Object(T["isEmpty"])(n)){t.next=16;break}return t.prev=2,t.next=5,e.HTN.createEncounter();case 5:return t.t0=e.HTN,t.next=8,Promise.all(n);case 8:return t.t1=t.sent,t.next=11,t.t0.saveObservationList.call(t.t0,t.t1);case 11:t.next=16;break;case 13:return t.prev=13,t.t2=t["catch"](2),t.abrupt("return",Object(_["e"])("Unable to save notes ".concat(t.t2)));case 16:e.gotoTreatment();case 17:case"end":return t.stop()}}),t,null,[[2,13]])})))()},gotoTreatment:function(){var e=this.selectedDrugs.map((function(e){return Object(T["find"])(I["a"].htnDrugReferences(),{drug_id:e.drugID})})),t={};t[this.patientID]=e,sessionStorage.setItem(I["b"].Prescription,JSON.stringify(t)),this.$router.push("/art/encounters/prescriptions/".concat(this.patientID))},showModal:function(e,t){return Object(V["a"])(regeneratorRuntime.mark((function n(){var o;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,x["X"].create({component:y["a"],backdropDismiss:!1,cssClass:"full-modal",componentProps:{dismissType:"modal",currentField:e,onFinish:t}});case 2:o=n.sent,o.present();case 4:case"end":return n.stop()}}),n)})))()},setPreviousBpNotes:function(e){var t=this,n=function(n){t.drugs[n].notes=Object.keys(e[n]).map((function(t){return e[n][t].map((function(e){return{date:t,description:e,isNewNote:!1}}))})).reduce((function(e,t){return e.concat(t)}),[])};for(var o in e)n(o)},setPreviousBpDrugs:function(e){var t=this;e.forEach((function(e){var n=function(n){t.drugs[n].drugs.forEach((function(o,c){e.drug_id===o.drugID&&(t.drugs[n].drugs[c].current=!0,t.drugs[n].drugs[c].selected=!0,t.drugs[n].selected=e.drug_id)}))};for(var o in t.drugs)n(o)}))},selectDrug:function(e,t,n){var o=this;this.drugs[e].drugs.forEach((function(t,n){o.drugs[e].drugs[n].selected=!1})),this.drugs[e].drugs[t].selected=n.detail.checked}},computed:{selectedDrugs:function(){return this.drugs?Object.values(this.drugs).map((function(e){return e.drugs})).reduce((function(e,t){return e.concat(t)}),[]).filter((function(e){return e.selected})):[]}}}),P=(n("c2f2"),n("6b0d")),H=n.n(P);const L=H()(S,[["render",C],["__scopeId","data-v-7217b18a"]]);t["default"]=L},4582:function(e,t,n){},c2f2:function(e,t,n){"use strict";n("4582")},e6e9:function(e,t,n){"use strict";var o=n("7a23");const c=Object(o["createTextVNode"])(" Close "),r=Object(o["createTextVNode"])(" Clear "),a=Object(o["createTextVNode"])(" Done ");function i(e,t,n,i,l,s){const u=Object(o["resolveComponent"])("ion-title"),d=Object(o["resolveComponent"])("ion-toolbar"),b=Object(o["resolveComponent"])("ion-header"),O=Object(o["resolveComponent"])("ion-content"),j=Object(o["resolveComponent"])("ion-button"),p=Object(o["resolveComponent"])("ion-footer"),f=Object(o["resolveComponent"])("ion-page");return Object(o["openBlock"])(),Object(o["createBlock"])(f,null,{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(b,null,{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(d,null,{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(u,{class:"his-lg-text ion-text-center"},{default:Object(o["withCtx"])(()=>[Object(o["createTextVNode"])(Object(o["toDisplayString"])(e.currentField.helpText),1)]),_:1})]),_:1})]),_:1}),Object(o["createVNode"])(O,null,{default:Object(o["withCtx"])(()=>[(Object(o["openBlock"])(),Object(o["createBlock"])(o["KeepAlive"],null,[(Object(o["openBlock"])(),Object(o["createBlock"])(Object(o["resolveDynamicComponent"])(e.currentField.type),{key:e.currentField.id,currentFieldig:e.currentField.currentFieldig,options:e.currentField.options,preset:e.currentField.preset,clear:e.valueClearIndex,fdata:e.formData,config:e.currentField.config,cdata:e.computedFormData,activationState:e.state,onValue:e.currentField.onValue,defaultValue:e.currentField.defaultValue,onValueUpdate:e.currentField.onValueUpdate,onOnValue:e.onFieldValue},null,8,["currentFieldig","options","preset","clear","fdata","config","cdata","activationState","onValue","defaultValue","onValueUpdate","onOnValue"]))],1024))]),_:1}),Object(o["createVNode"])(p,null,{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(d,{color:"light"},{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(j,{disabled:e.disableBtn,onClick:e.onClose,slot:"start",color:"danger",size:"large"},{default:Object(o["withCtx"])(()=>[c]),_:1},8,["disabled","onClick"]),Object(o["createVNode"])(j,{disabled:e.disableBtn,onClick:e.onClear,slot:"end",color:"warning",size:"large"},{default:Object(o["withCtx"])(()=>[r]),_:1},8,["disabled","onClick"]),Object(o["createVNode"])(j,{disabled:e.disableBtn,onClick:e.onDone,slot:"end",color:"success",size:"large"},{default:Object(o["withCtx"])(()=>[a]),_:1},8,["disabled","onClick"])]),_:1})]),_:1})]),_:1})}var l=n("b5e4"),s=n("d95e"),u=n("8a30");function d(){const e={};return s["a"].forEach(t=>{e[t]=Object(o["defineAsyncComponent"])(()=>n("f159")(`./${t}.vue`))}),e}var b=Object(o["defineComponent"])({name:"SingleFieldTouchForm",components:{IonPage:u["D"],IonContent:u["n"],IonFooter:u["o"],IonToolbar:u["Q"],IonButton:u["d"],IonHeader:u["q"],IonTitle:u["P"],...d()},props:{dismissType:{type:String},onFinish:{type:Function,required:!0},currentField:{type:Object,required:!0}},data:()=>({valueClearIndex:0,formData:{},computedFormData:{},state:"",value:null,disableBtn:!1}),methods:{onClose(){"modal"===this.dismissType?u["X"].dismiss():this.$router.back()},onClear(){this.valueClearIndex+=1,this.value=null},onFieldValue(e){this.value=e},onDone(){if(this.disableBtn=!0,this.currentField.validation){const e=this.currentField.validation(this.value);if(this.disableBtn=!1,e)return Object(l["e"])(e.join(", "),6e4)}try{this.onFinish(this.value)}catch(e){Object(l["c"])(e),console.error(e)}this.onClose(),this.disableBtn=!1}}}),O=n("6b0d"),j=n.n(O);const p=j()(b,[["render",i]]);t["a"]=p}}]);
//# sourceMappingURL=chunk-0d24d27e.ce6b0c4d.js.map