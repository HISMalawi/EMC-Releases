(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-65365de6"],{"30f4":function(t,e,r){"use strict";r.r(e);var a=r("7a23");function o(t,e,r,o,n,s){const i=Object(a["resolveComponent"])("report-template"),h=Object(a["resolveComponent"])("ion-page");return Object(a["openBlock"])(),Object(a["createBlock"])(h,null,{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(i,{reportPrefix:"MoH",title:t.title,period:t.period,rows:t.rows,fields:t.fields,columns:t.columns,config:{showIndex:!0},validationErrors:t.errors,showValidationStatus:t.showStatus,headerInfoList:t.headerList,onReportConfiguration:t.onPeriod},null,8,["title","period","rows","fields","columns","validationErrors","showValidationStatus","headerInfoList","onReportConfiguration"])]),_:1})}var n=r("ad8d"),s=r("87e7"),i=r("44e3"),h=r("2ef0"),d=r("4ba2"),c=r("9ceb"),u=r("8a30"),l=r("b31c"),p=Object(a["defineComponent"])({mixins:[i["a"]],components:{ReportTemplate:d["a"],IonPage:u["D"]},data:()=>({title:"TPT new initiations report",rows:[],cohort:{},canValidate:!1,mohCohort:{},headerList:[],errors:[],showStatus:!1,columns:[[c["a"].thTxt("District"),c["a"].thTxt("Age group"),c["a"].thTxt("Gender"),c["a"].thNum("3HP (Started New on ART)"),c["a"].thNum("6H (Started New on ART)"),c["a"].thNum("3HP (Started Previously on ART)"),c["a"].thNum("6H (Started Previously on ART)")]],totalIpt:[],total3hp:[]}),watch:{async canValidate(t){t&&await this.validateReport()}},created(){this.fields=this.getDateDurationFields()},methods:{async onPeriod(t,e){this.canValidate=!1,this.rows=[],this.errors=[],this.showStatus=!1,this.totalIpt=[],this.total3hp=[],this.report=new s["d"],this.mohCohort=new l["a"],this.mohCohort.setStartDate(e.start_date),this.mohCohort.setEndDate(e.end_date),this.report.setStartDate(e.start_date),this.report.setEndDate(e.end_date),this.period=this.report.getDateIntervalPeriod(),this.cohort=await this.report.getTptNewInitiations(),this.setRows("F"),this.setRows("M"),this.canValidate=!0,this.showStatus=!0},drilldown(t,e){const r=[[c["a"].thTxt("ARV #"),c["a"].thTxt("DOB"),c["a"].thTxt("Dispensed date")]],a=()=>this.sortByArvNumber(t).map(t=>[c["a"].td(t.arv_number),c["a"].tdDate(t.birthdate),c["a"].tdDate(t.dispensation_date)]);return t.length<=0?c["a"].td(0):c["a"].tdLink(t.length,()=>this.drilldownAsyncRows(e,r,a))},setRows(t){const e=this.formatGender(t);for(const r in n["a"]){const a=n["a"][r],o=this.cohort["Location"];if(!Object(h["isEmpty"])(this.cohort)&&a in this.cohort&&r){const r=this.cohort[a];this.total3hp=Object(h["uniq"])([...this.total3hp,...r["3HP_new"][t],...r["3HP_prev"][t]]),this.totalIpt=Object(h["uniq"])([...this.totalIpt,...r["6H_new"][t],...r["6H_prev"][t]]),this.rows.push([c["a"].td(o),c["a"].td(a),c["a"].td(e),this.drilldown(r["3HP_new"][t],`${a} ${e}s New on 3HP`),this.drilldown(r["6H_new"][t],`${a} ${e}s New on 6H`),this.drilldown(r["3HP_prev"][t],`${a} ${e}s Previously on 3HP`),this.drilldown(r["6H_prev"][t],`${a} ${e}s Previously on 6H`)])}else this.rows.push([c["a"].td(a),c["a"].td(e),c["a"].td(0),c["a"].td(0)])}},validateReport(){const t={newly_initiated_on_3hp:{param:this.total3hp.length,check:(t,e)=>t!=e,error:(t,e)=>`\n                        Total newly initiated on <b>3HP(${e})</b> is not matching newly \n                        initiated on 3HP in Cohort report <b>(${t})</b>.\n                    `},newly_initiated_on_ipt:{param:this.totalIpt.length,check:(t,e)=>t!=e,error:(t,e)=>`\n                        Total newly initiated on IPT <b>(${e})</b> is not matching \n                        newly initiated on IPT in Cohort report <b>(${t})</b>.\n                    `}},e=this.mohCohort.validateIndicators(t,t=>this.errors=t);-1===e&&(this.errors=["Report not validated. Run the MoH cohort report for similar reporting period and then run this report"])}}}),g=r("6b0d"),m=r.n(g);const w=m()(p,[["render",o]]);e["default"]=w},ad8d:function(t,e,r){"use strict";r.d(e,"a",(function(){return o})),r.d(e,"b",(function(){return n}));var a=r("5969");const o=["<1 year","1-4 years","5-9 years","10-14 years","15-19 years","20-24 years","25-29 years","30-34 years","35-39 years","40-44 years","45-49 years","50-54 years","55-59 years","60-64 years","65-69 years","70-74 years","75-79 years","80-84 years","85-89 years","90 plus years"];class n extends a["a"]{constructor(){super()}getBookedAppointments(t){return a["a"].getJson(`programs/${this.programID}/scheduled_appointments`,{date:t})}getViralLoadResults(t){return this.getReport(`/programs/${this.programID}/reports/high_vl_patients`,{range:t})}getOtherOutcome(t){return this.getReport("patient_outcome_list",{outcome:t})}getPatientVisitTypes(){return this.getReport("patient_visit_types")}getClientsDueForVl(){return this.getReport("clients_due_vl")}getClientRentention(){return this.getReport(`/programs/${this.programID}/reports/retention`)}getExternalConsultationClients(){return this.getReport(this.programID+"/external_consultation_clients")}getMissedAppointments(){return this.getReport("missed_appointments")}getPregnantWomen(){return this.getReport(`/programs/${this.programID}/reports/pregnant_patients`)}getArchivingCandidates(){return a["a"].getJson(`programs/${this.programID}/reports/archiving_candidates`,{start_date:this.date})}}},b31c:function(t,e,r){"use strict";r.d(e,"a",(function(){return c}));var a,o=r("d4ec"),n=r("bee2"),s=r("262e"),i=r("2caf"),h=(r("99af"),r("e9c4"),r("d3b7"),r("b64b"),r("2ef0")),d=r("5969");(function(t){t["MOH_CACHE"]="mohCache"})(a||(a={}));var c=function(t){Object(s["a"])(r,t);var e=Object(i["a"])(r);function r(){var t;return Object(o["a"])(this,r),t=e.call(this),t.regenerate=!1,t}return Object(n["a"])(r,[{key:"cohortUrl",value:function(){return"programs/".concat(this.programID,"/reports/cohort")}},{key:"setRegenerate",value:function(t){this.regenerate=t}},{key:"getCohortDrillDown",value:function(t){return d["a"].getJson("cohort_report_drill_down",{id:t,date:this.date,program_id:this.programID})}},{key:"requestCohort",value:function(t){return d["a"].ajxGet(this.cohortUrl(),t)}},{key:"qaurterRequestParams",value:function(){return{name:this.quarter,regenerate:this.regenerate}}},{key:"datePeriodRequestParams",value:function(){return{name:"Cohort-".concat(this.startDate,"-").concat(this.endDate),start_date:this.startDate,end_date:this.endDate,regenerate:this.regenerate}}},{key:"getCachedCohortValues",value:function(){var t=sessionStorage.getItem(a.MOH_CACHE);if(t){var e=JSON.parse(t);if(e.start_date===this.startDate&&e.end_date===this.endDate||e.quarter===this.quarter)return e.data}}},{key:"cacheCohort",value:function(t){sessionStorage.setItem(a.MOH_CACHE,JSON.stringify({start_date:this.startDate,end_date:this.endDate,quarter:this.quarter,data:t}))}},{key:"validateIndicators",value:function(t,e){var r=this.getCachedCohortValues();if(r){var a=Object.keys(t).reduce((function(e,a){var o=Object(h["find"])(r,{name:a}),n=t[a],s=o?o.contents:null,i=n.param,d=n.check(parseInt(s),i);return d&&e.push(n.error(s,i)),e}),[]);return e(a)}return-1}}]),r}(d["a"])}}]);
//# sourceMappingURL=chunk-65365de6.c98b4038.js.map