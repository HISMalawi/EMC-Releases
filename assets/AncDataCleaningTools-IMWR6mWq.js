import{d as c,I as u,V as _,ab as T,cF as f,L as e,cG as i,S as l,H as x,_ as w,r as m,o as D,c as I,w as S,b as g}from"./index-iM2cGz0p.js";import{_ as v}from"./ReportMixin.vue_vue_type_script_lang-r1arG92A.js";import{R as E}from"./TableReportTemplate-A4sKSoQg.js";import{F as N}from"./dynamic-import-helper-9HnG3Mif.js";import{g as d}from"./MultiFieldDateHelper-BIZNjBD7.js";import"./BasicReportTemplate-Cy-G-sIO.js";import"./Export-VO9zGhWb.js";import"./SIngleTouchField-TVlhbHrr.js";import"./Pagination-nCJl9BUM.js";import"./HisStandardForm-tiWNF5wA.js";import"./TouchScreenForm-hvB0I83y.js";import"./ToolbarMediumCard-ny9gUih7.js";import"./Transformers-XlEF3tgP.js";import"./ViewPort-4mhPlN2U.js";import"./ReportErrors-SvbbPxAT.js";import"./KbLayouts-9dqmDWmG.js";import"./HisKbConfigurations-a7K7dizM.js";const C=c({mixins:[v],components:{ReportTemplate:E,IonPage:u},data:()=>({title:"Data cleaning report",rows:[],columns:[],defaultIndicator:{}}),created(){this.fields=[{id:"indicator",helpText:"Select indicator",type:N.TT_SELECT,requireNext:!1,condition:()=>!this.defaultIndicator,defaultOutput:()=>this.defaultIndicator,validation:t=>_.required(t),options:()=>this.getIndicatorOptions()},...d({id:"start_date",helpText:"Start",required:!0,minDate:()=>"2000-01-01",maxDate:()=>l.getSessionDate(),estimation:{allowUnknown:!1},computeValue:t=>t}),...d({id:"end_date",helpText:"End",required:!0,minDate:(t,a)=>a.start_date,maxDate:()=>l.getSessionDate(),estimation:{allowUnknown:!1},computeValue:t=>t})],this.defaultIndicator=T.find(this.getIndicatorOptions(),{value:this.$route.query.cleaning_tool})||null},methods:{async onPeriod(t,a){const r=n=>x.toStandardHisDisplayFormat(n);this.rows=[],this.title=t.indicator.label;const o=t.indicator;this.columns=o.other.columns,this.report=new f,this.report.setStartDate(a.start_date),this.report.setEndDate(a.end_date),this.period="".concat(r(a.start_date)," - ").concat(r(a.end_date));const s=await this.report.getDataToolReport(o.value);s&&(this.rows=await Promise.all(s.map(n=>o.other.formatRow(n))))},showPatientBtn(t){return e.tdBtn("View",()=>this.$router.push("/patient/dashboard/"+t))},getIndicatorOptions(){return[{label:"Males with ANC Encounters",value:i.MALES_WITH_ANC_ENCOUNTERS,other:{columns:[[e.thTxt("National ID"),e.thTxt("First name"),e.thTxt("Last name"),e.thTxt("Total Encounters"),e.thTxt("Action")]],formatRow:t=>[e.td(t.identifier),e.td(t.given_name),e.td(t.family_name),e.td(t.total_encounters),this.showPatientBtn(t.patient_id)]}},{label:"Encounters after death",value:i.ENCOUNTERS_AFTER_DEATH,other:{columns:[[e.thTxt("National ID"),e.thTxt("First name"),e.thTxt("Last name"),e.thTxt("Date of death"),e.thTxt("Recent encounter date"),e.thTxt("Count"),e.thTxt("Action")]],formatRow:t=>[e.td(t.identifier),e.td(t.given_name),e.td(t.family_name),e.tdDate(t.patient_died_date),e.tdDate(t.minimum_encounter_datetime),e.td(t.total_encounters),this.showPatientBtn(t.patient_id)]}},{label:"Incomplete visits",value:i.INCOMPLETE_VISITS,other:{columns:[[e.thTxt("National ID"),e.thTxt("Name"),e.thTxt("Visit date"),e.thTxt("Incomplete count"),e.thTxt("Action")]],formatRow:t=>[e.td(t.n_id),e.td(t.name),e.td(t.visit_date),e.td(t.visit_no),this.showPatientBtn(t.patient_id)]}},{label:"Duplicate encounters",value:i.DUPLICATE_ENCOUNTERS,other:{columns:[[e.thTxt("National ID"),e.thTxt("Given name"),e.thTxt("Family name"),e.thTxt("Name"),e.thTxt("Total"),e.thTxt("Action")]],formatRow:t=>[e.td(t.identifier),e.td(t.given_name),e.td(t.family_name),e.td(t.name),e.td(t.total),this.showPatientBtn(t.patient_id)]}},{label:"Missing HIV Status",value:i.MISSING_HIV_STATUS,other:{columns:[[e.thTxt("National ID"),e.thTxt("Given name"),e.thTxt("Family name"),e.thTxt("Action")]],formatRow:t=>[e.td(t.identifier),e.td(t.given_name),e.td(t.family_name),this.showPatientBtn(t.patient_id)]}}]}}});function R(t,a,r,o,s,n){const h=m("report-template"),p=m("ion-page");return D(),I(p,null,{default:S(()=>[g(h,{title:t.title,period:t.period,rows:t.rows,fields:t.fields,columns:t.columns,showFilters:!0,onReportConfiguration:t.onPeriod},null,8,["title","period","rows","fields","columns","onReportConfiguration"])]),_:1})}const j=w(C,[["render",R]]);export{j as default};
