(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5070e560"],{8866:function(e,t,a){"use strict";a.r(t);a("14d9");var n=a("7a23"),r=a("d95e"),i=a("7920"),l=a("b515"),o=a("2ef0"),s=a("7f35"),u=a("b5e4"),c=a("93c7"),d=Object(n["defineComponent"])({__name:"AncVitals",setup(e){const t=Object(n["ref"])(0),a=Object(n["ref"])(-1),d=Object(n["ref"])(-1),h=Object(n["ref"])(-1),v=Object(n["ref"])([]);let b;const{patientDashboardUrl:f,goToNextTask:m}=Object(c["a"])(O),g={label:"Weight",value:"",other:{modifier:"KG",icon:"weight",required:!0}},p={label:"BP",value:"",other:{modifier:"mmHG",icon:"bp"}},w=Object(n["computed"])(()=>({label:"Age",value:t.value,other:{doNotSave:!0,modifier:"Years old",icon:"",visible:!1}})),y=Object(n["computed"])(()=>{const e=a.value>0&&t.value>18;return{label:"Height",value:""+(e?a.value:""),other:{modifier:"CM",icon:"height",recentHeight:a.value,visible:!e}}});async function O(e,n,r){var i,o;b=new l["a"](n,e);const s=await l["a"].getFirstObs(n,"Weight");d.value=parseFloat(""+(null!==(i=null===s||void 0===s?void 0:s.value_numeric)&&void 0!==i?i:0)),h.value=parseInt(""+(null!==(o=null===s||void 0===s?void 0:s.obs_id)&&void 0!==o?o:-1)),t.value=r.getAge(),a.value=await r.getRecentHeight(),v.value.push(k())}function j(e){const t=M(e);if(t.length>0)return t.map(e=>[e.label+" can not be empty"]);const a=E(e);return b.validateAll(a)}function E(e){return e.filter(e=>("Height"!==e.label||0!=e.other.required)&&(""!==e.value&&"Age"!==e.label))}function M(e){return e.filter(e=>""===e.value&&!0===e.other.required)}function N(e){const t=Object(o["find"])(e,{label:"BP"});if(t&&""!=t.value){const[e,a]=(""+t.value).split("/").map(e=>parseInt(e));if(e>=140&&a>=90)return{status:"Client is at risk of pre-eclampsia, refer for urine protein test.",color:"brown"};if(e<120||e>140)return{status:"Systolic reading is out of normal range",color:"brown"};if(a<80||a>90)return{status:"Diastolic reading is out of normal range",color:"brown"};if(e>=130&&e<=139&&a>=80&&a<=89)return{status:"Prehypertension",color:"brown"}}return{status:"",color:""}}async function P(e){const t=parseFloat(""+(e.value||0)),a=t-d.value,n=100*(Math.abs(a)/d.value||1);if(n>30){const e=`Use ${d.value} Kg`,n=`Use ${t} Kg`,r=await Object(s["a"])("Abnormal Weight Change",`Previous Weight "${d.value} Kg". Current Weight "${t} Kg"`,`Weight Reading has been ${a>0?"increased":"decresed"} by more than 30%. Please SELECT the correct Weight.)`,[{name:e,slot:"start",color:"success"},{name:n,slot:"end",color:"danger"}]);if(r!==n||!h)return d.value;await Object(u["a"])("Do you want to void Weight observation for "+d.value)&&await l["a"].voidObs(h.value)}return t}async function $(e){if(!e.value&&e.other.required)throw`Value for ${e.label} is required`;if(e.value){const t=b.validator(e);if(t&&t.length)throw t}"Weight"===e.label&&d.value>0&&(e.value=await P(e))}function k(){return{id:"vitals",helpText:"Vitals entry",type:r["b"].TT_VITALS_ENTRY,validation:j,options:()=>[g,y.value,p,w.value],config:{onUpdateAlertStatus:N,onChangeOption:$,hiddenFooterBtns:["Clear"]}}}async function A(e){const[t,a]=e.split("/");return[await b.buildValueNumber("Systolic",parseInt(t)),await b.buildValueNumber("Diastolic",parseInt(a))]}async function x(e){const t=await Promise.all(e.filter(e=>{var t;return!(null!==(t=e.other)&&void 0!==t&&t.doNotSave||Object(o["isEmpty"])(e.value))}).map(async e=>"BP"===e.label?A(e.value):("Weight"===e.label&&d.value>0&&(e.value=await P(e)),b.buildValueNumber(e.label,e.value))));return t.flat()}async function B(e){const t=Object(o["find"])(e,{label:"Height"});return(null===t||void 0===t?void 0:t.value)>0||!await Object(u["a"])("Patient has no height reading. Do you want to proceed without recording height?",{header:"HEIGHT CONFIRMATION",confirmBtnLabel:"Enter Height",cancelBtnLabel:"Proceed"})}async function I({vitals:e}){if(!await B(e))return;await b.createEncounter();const t=await x(e);await b.saveObservationList(t),m()}return(e,t)=>(Object(n["openBlock"])(),Object(n["createBlock"])(i["a"],{fields:v.value,onFinishAction:I,skipSummary:!0,cancelDestinationPath:Object(n["unref"])(f)},null,8,["fields","cancelDestinationPath"]))}});const h=d;t["default"]=h},b515:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));a("14d9");var n=a("cc6f"),r=a("2ef0");class i extends n["a"]{constructor(e,t){super(e,6,t)}isNotEmptyandNumber(e){return(""+e.value).match(/^-?\d+\.?\d*$/)?null:["Invalid entry for "+e.label]}isNotEmptyandFloat(e){return(""+e.value).match(/^\d{1,3}\.\d{1,5}$/)?null:[`Invalid entry for ${e.label}. Don't forget to add a decimal. e.g. 56.2 ${e.other.modifier}`]}checkMinMax(e,t,a){const n=[];var r,i;parseFloat(""+e.value)<t&&n.push([`${e.label} entered is less than minimum ${t} ${(null===e||void 0===e||null===(r=e.other)||void 0===r?void 0:r.modifier)||""}`]);parseFloat(""+e.value)>a&&n.push([`${e.label} entered is greater than maximum ${a} ${(null===e||void 0===e||null===(i=e.other)||void 0===i?void 0:i.modifier)||""}`]);return n.length>0?n:null}validateAll(e){const t=[];return e.map(e=>{const a=this.validator(e);return Object(r["isArray"])(a)?t.push(a):null}),t.length>0?t:null}mergeErrors(e){const t=[];return e.forEach(e=>{Object(r["isArray"])(e)&&t.push(e)}),t.length>0?t:null}isValidBPReading(e){const t=[],a=(""+e.value).match(/^\d{1,3}\/\d{1,3}$/g)?null:["Invalid BP reading"];if(t.push(a),null==a){const a=(""+e.value).split("/"),n={label:"Systolic",value:a[0]},r={label:"Diastolic",value:a[1]};t.push(this.checkMinMax(r,30,200)),t.push(this.checkMinMax(n,40,250))}return this.mergeErrors(t)}validator(e){const t=[{name:"Weight",validator:e=>{const t=this.isNotEmptyandFloat(e),a=this.checkMinMax(e,2,250);return this.mergeErrors([t,a])}},{name:"Height",validator:e=>{const t=[];return t.push(this.isNotEmptyandNumber(e)),t.push(this.checkMinMax(e,40,220)),this.mergeErrors(t)}},{name:"BP",validator:e=>this.isValidBPReading(e)},{name:"Temp",validator:e=>{const t=this.isNotEmptyandNumber(e),a=this.checkMinMax(e,30,42);return this.mergeErrors([t,a])}},{name:"SP02",validator:e=>{const t=this.checkMinMax(e,40,100);return this.mergeErrors([t])}},{name:"Pulse",validator:e=>{const t=this.checkMinMax(e,50,120);return this.mergeErrors([t])}}],a=t.filter(t=>t.name===e.label);return a.length>0?a[0].validator(e):null}}}}]);
//# sourceMappingURL=chunk-5070e560.0506aaf6.js.map